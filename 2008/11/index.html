<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><title></title><link href="/stylesheets/dist/normalize.css" rel="stylesheet" /><link href="/stylesheets/dist/skeleton.css" rel="stylesheet" /><link href="/stylesheets/all.css" rel="stylesheet" /><script src="/javascripts/all.js"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="x2008 x2008_11 x2008_11_index"><div class="header"><div class="header-title"><h1><a href="/">ukstudio</a></h1></div></div><div class="container"><h1><Archive></Archive>Nov 2008</h1><article><h2><a href="/2008/11/27/mac_gem_install_mysql/">2008-11-27 Macでgem install mysqlをする方法</a></h2>Rails2.2からmysqlのアダプタが付属していないので各個人でインストールする必要があります。gemで入れようとするとエラーがでると思うので以下のように対応してください。

<pre lang="bash">
$ sudo gem install mysql
$ cd /opt/local/lib/ruby/gems/1.8/gems/mysql-2.7/
$ sudo ruby extconf.rb --with-mysql-config=/opt/local/lib/mysql5/bin/mysql_config
$ sudo make
$ sudo make install
</pre>

パスに関しては、人によって違うかもしれませんが適宜読み替えてください。

追記

<pre lang="bash">
$ sudo gem install mysql -- --with-mysql-config=/opt/local/lib/mysql5/bin/mysql_config
</pre>

これでも大丈夫らしい。
</article><hr /><article><h2><a href="/2008/11/26/rails_22_i18n/">2008-11-26 Rails2.2のi18n(国際化)を簡単に試してみた</a></h2>11月21日にRails2.2が正式リリースされた。 RCなどでチェックしてた人は既に知っているかもしれないけど、2.2からデフォルトでi18n(国際化)対応がされている。

ちなみにi18nというのはinternationalizationの頭と後ろのiとn、文字数が18文字というところから来てるらしい。

とりあえず、まずはアプリの作成。

<pre lang="bash">
$ rails i18n_demo
</pre>

作成されたファイル群の中にconfig/locales/en.ymlというファイルが出来ていると思うけど、これが翻訳ファイルになる。今回は英語と日本語を用意しようと思うので、en.ymlをコピーしてja.ymlを作成する。

<pre lang="bash">
$ cp config/locales/en.yml config/locales/ja.yml
</pre>

翻訳ファイルを修正しようにも、そもそもアプリケーションが出来ていないので、scaffoldで簡単に作ってしまおう。

<pre lang="bash">
$ ruby script/generate scaffold entry title:string body:text
$ rake db:migrate
</pre>

とりあえずは適当にサイトタイトル的なものでも作ってみよう。翻訳ファイルに関しては元々あった内容は削除してしまっていい。

<pre lang="ruby">
# config/locales/ja.yml
ja:
  site_title: サイトタイトル
</pre>

一応英語も。

<pre lang="ruby">
# config/locales/en.yml
en:
  site_title: SiteTitle
</pre>

Viewの修正。

<pre lang="ruby">
# app/views/entries/index.html.erb
<h1>translation missing: en.site_title</h1>
</pre>

この状態でサーバーを起動し、http://localhost:3000/entriesにアクセスしてみる。「SiteTitle」という文字が表示されているはずだ。この状態だとまだ言語がデフォルトの英語の設定になっている。多分、ブラウザの言語設定とかは見てなさげ?。ちょっとソースを見てないのでまだ未確認。もしかしたら、リクエストのヘッダーを見て言語を決める部分は自分で実装しなきゃいけないのかもしれない。

なんにせよ、日本語で表示したい場合は以下のようにする。

<pre lang="ruby">
# config/environment.rb
# 最下行に追加
I18n.default_locale = "ja"
</pre>

これで再度アクセスすれば「サイトタイトル」と表示されているはずだ。

次にGETパラメータで言語が切り替わるようにしてみよう。

<pre lang="ruby">
# app/controllers/application.rb

before_filter :set_locale
def set_locale
  I18n.locale = params[:locale]
end
</pre>

これでhttp://localhost:3000/entries?locale=enで「SiteTitle」と表示されているはずだ。

次にモデルの日本語化をしてみよう。まずはエラーメッセージを出すためにバリデーションを追加する。

<pre lang="ruby">
# app/model/entry.rb
class Entry < ActiveRecord::Base
  validates_presence_of :title, :body
end
</pre>

http://localhost:3000/entry/newでフォームに何も入力せず送信すればエラーがでるので英語で表示されていることを確認する。

<a href="http://ukstudio.jp/wp-content/uploads/2008/11/082611_i18n_en_error.jpg"><img src="http://ukstudio.jp/wp-content/uploads/2008/11/082611_i18n_en_error.jpg" alt="" title="082611_i18n_en_error" width="300" height="281" class="alignnone size-medium wp-image-257" /></a>

普通のバリデーションのエラーとは違うエラーがでているけど、これは翻訳ファイルをちゃんと書いてないからでているエラー。英語の方はちょっと面倒なので無視するが、とりあえず日本語化をすすめる。

<pre lang="ruby">
#config/locales/ja.yml
ja:
  site_title: サイトタイトル
    activerecord:
      errors:
        template:
          header: "{{model}}でエラーが発生しました。"
          body:   以下のエラー内容を確認してください。
        messages:
          blank:  が空白です。
      models:
        entry: エントリー
      attributes:
        entry:
          title: タイトル
          body: 本文
</pre>

以上の修正をして、もう一度エラーを出してみるとエラーが日本語に変わっているはずだ。翻訳ファイルのどの部分がどの部分に対応してるかは雰囲気でわかると思う。

<a href="http://ukstudio.jp/wp-content/uploads/2008/11/081126_i18n_ja_error.jpg"><img src="http://ukstudio.jp/wp-content/uploads/2008/11/081126_i18n_ja_error.jpg" alt="" title="081126_i18n_ja_error" width="300" height="225" class="alignnone size-medium wp-image-258" /></a>

今回は必要な部分だけ翻訳したけど、もうちょっとちゃんとした翻訳ファイルが必要なら<a href="http://i18n-demo.phusion.nl/pages/setup">Railsをローカライズする</a>も参考にするといいと思う。

諸々めんどくせー!って人は松田さんの<a href="http://blog.dio.jp/2008/11/22/japanizing-rails-2-2-by-i18n-generators">Rails 2.2の I18nによる日本語化を最も簡単に行う方法</a>へどうぞ。gemで一発です。

まだ2.2はリリースされたばかりで、i18nまわりの日本語の情報はあまり多くはないと思うけど、そこまで複雑な仕組みでもないし、翻訳ファイルに関して言えば基本的な部分(ActiveRecordとか)は使い回しができるので手間もそこまで大きくはないと思う。ブラウザの言語設定での判断もそのうちプラグインがでてくるんじゃないかと思っている。

「国際化とか必要ないよー」の人も、バリデーションのエラーを日本語化するのにgettextを入れる必要がなくなったりとこれでかなりラクになるんじゃなかろうか。
</article><hr /><article><h2><a href="/2008/11/23/vimm3-2/">2008-11-23 VimM#3を開催してきました</a></h2>﻿﻿﻿﻿﻿﻿﻿﻿﻿本日、VimM#3を東京大学秋葉原キャンパスにて開催してきました。協力頂いた、星さん、笹田さんありがとうございました。また、参加頂いたみなさん、本当にありがとうございました。グダグダな部分もありましたが、無事終えることができました。

以下、簡単な感想。

<h2>Vimで効率的なテキスト編集 - ukstudio</h2>
自分の発表。相変わらず準備不足・・・とりあえず資料。


なるべく、チュートリアルに載っていなくて初心者が知らなそうなものをいくつか選んだつもりだったけど、ちょっと微妙だったかも。

<h2>マクロ - taku-o</h2>
<a href="http://nanasi.jp/">名無しのvim使い</a>のtaku-oさんによるマクロの説明。

実はマクロとか全然使ったことがなかったので参考になりました。なんとなくマクロは避けてた、と言うよりは無理に触れようとしてなかったんだけど仕組み自体は簡単そうなのでちょっと使っていこうかなと。とりあえずこう言うのは無理にでも書かないと感覚が掴めなさそうなのでちょっと頑張る。

<h2>俺の.vimrcを見ろ!PHP使いの為の設定プラグイン - halt</h2>
PHPerである<a href="http://project-p.jp/halt/">halt</a>さんによる発表。

「武士にとっての刀」というフレーズがおれの発表と丸被りで焦ったw autocomplpop.vimの紹介も実は簡単にしようかなと思っていたのだけど、こちらは省いたおかげで被らずに済んだ・・・

PHPのマニュアルをVimのヘルプにコンバートはいいアイディアだなと思った。確かにマニュアルを見るときはプログラミングを書いてるときなので、その方が手間は少なそう。
<h2>operator. the true power of Vim - kana</h2>
<a href="http://whileimautomaton.net/">kana</a>さんによる発表。

Vimの習熟度によってLv0〜Lv7を定義。ちなみにおれはLv3でした。ビジュアルモードを使わなくなってやっとLv4らしい。あとテキストオブジェクトやばい。ライフチェンジン>グとは聞いていたけど、なかなか馴染めなくて後回しにしてたせいで結局身についてない・・・

とりあえず、ap、ipから覚えることにした。ちなみにLv7は1年じっくりVimを使えば辿りつけるらしい。

<h2>第２部 Q&Aセッション</h2>
Lingrだかどっかでkanaさんがボソっと言ったことにより企画したセッション。会場の人に質問してもらって、会場の人に答えてもらう。

正直、始めるまでは「質問なかったらどうしよう」とビクビクしたけど、正直グダグダなところはありつつも結構盛り上がったようなので良かったのかなと。もうちょっとうまく仕切れたらよかったのだけれど。あとマイクとかはあった方が良かったのかもしれない。

それともったいないなぁと終わったあとに思ったのは、質問内容とそれに対する回答を記録してなかったこと。前で仕切りながらやるのは厳しいので誰かにお願いしとけばよかったのかも。


<h2>謝辞</h2>
何はともあれ、なんとか無事に終えることができました。多数のご参加とご協力ありがとうございました!
</article><hr /><article><h2><a href="/2008/11/14/rubygems_update/">2008-11-14 RubyGemsのupdateの方法が変わっていた</a></h2>せっかくMerb1.0がでたことだしインストールしてみようかと思ったら、gemを1.3以上いれやがれ!と怒られてしまった。それならアップデートするかーと思い、update --systemをやってsuccessと出たはいいけど、gem -vで1.2と表示される。MacPortsの方でアップデートして、1.3入れても-vは1.2でなんぞーとか思っていたらupdateの方法が変わってたみたい。

以下、update手順。

<ol>
<li><a href="http://rubyforge.org/frs/?group_id=126&release_id=16500">RubyForge</a>からrubygems-upate-1.3.1.gemをダウンロード</li>
<li><pre lang="bash">$ sudo gem install rubygems-update-1.3.1.gem</pre></li>
<li>update_rubygemsというコマンドができてるので実行。
<pre lang="bash">$ sudo update_rubygems</pre></li>
<li>完了</li>
</ol>

これで無事、RubyGemsの1.3.1がインストールされた。

<pre lang="bash">
$ gem -v
1.3.1
</pre>

<pre lang="bash">
$ sudo gem install merb
・・・
・・・
37 gems installed
</pre>

これでOK。37gems installedってのも凄いな。
</article><hr /><article><h2><a href="/2008/11/10/skitch/">2008-11-10 Skitchでキャプチャアップロード</a></h2><a href="http://d.hatena.ne.jp/snow-bell/20081110/1226249937">セキュリティの教訓 - snow-bellの日記</a>

snow-bellのところでgyazoのセキュリティが話題になってたので、ちょっとレスもかねてエントリー書く。

<a href="http://skitch.com/">Skitch.com</a>

今、オレが使ってるツールはgyazoじゃなくてSkitchというものを使ってる。デモが上で見れるのでそれを見てもらえばどんなものか大体わかるはず。

基本的な用途は、キャプチャ->編集->アップロード。大体gyazoと同じ。オレがgyazoを使わない理由は、画像の削除と公開範囲が指定できないってところが大きい。嘘です、先にSkitchを使ってたからです。

Skitchでできることは大体下記のとおり。

<ul>
<li>スクリーンキャプチャ</li>
<li>簡単な編集</li>
<li>アップロード</li>
<li>公開(非公開設定も可能)</li>
<li>アップロードした画像の削除</li>
</li>

アップロードした画像はskitch.comにログインすると自分のページから一覧することができる。
<div class="thumbnail"><a href="http://skitch.com/ukstudio/5rxm/skitch-sample"><img src="http://img.skitch.com/20081110-tr84wa9qcxag6cyj23954hfc5g.preview.jpg" alt="skitch-sample" /></a><br /><span style="font-family: Lucida Grande, Trebuchet, sans-serif, Helvetica, Arial; font-size: 10px; color: #808080">Uploaded with <a href="http://plasq.com/">plasq</a>'s <a href="http://skitch.com">Skitch</a>!</span></div>

アップロードした画像にはそれぞれにURLが割り当てられて、コピーしてすぐ使うことができる。

<img src="http://img.skitch.com/20081110-m89den1adars4y7qrahbsakdc2.jpg" alt="skitch-sample2"/>

ちなみにこのエントリーで使った画像もSkitchでキャプチャしたものです。多分、gyazoの方がアップロードの手間は少ないのかもしれないけど、編集(文字入れたいときとかたまにある)や、画像の削除、一覧がラクなのでSkitch愛用してます。
</article><hr /><article><h2><a href="/2008/11/07/vimrc/">2008-11-07 「地味に便利なVim設定」をもうちょい地味に便利にする</a></h2><a href="http://blog.blueblack.net/item_317">地味に便利なVim設定 - ナレッジエース</a>

いくつかもうちょい便利にできるよーってところがあったので書いてみる。

<h2>スペース + wで保存</h2>
別に¥¥で保存でもいいと思うけど、ちょっと指が遠い気がする。ので僕はスペース + wで保存してる。同じ要領でquitも。
<pre lang="vim">
nnoremap <space>w :<c-u>write<cr>
nnoremap <space>q :<c-u>quit<cr>
</pre>

<h2>jとkでカーソルキーを中心に保ってスクロール</h2>
わざわざスペースを使わなくてもできる。gj、gkにしておくと表示行で上下に移動できるので折り返しの行があるときとかに便利。
<pre lang="vim">
nnoremap j gjzz
nnoremap k gkzz
</pre>

ちなみに僕のvimrcはgithubに公開してあるのでよかったら参考にどうぞ。そんな大したものでもないですが。

<a href="http://github.com/ukstudio/config/tree/master">.vimrc at master from ukstudio's config - GitHub</a>
</article><hr /></div></body></html>