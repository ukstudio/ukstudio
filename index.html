<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><title>ukstudio.jp</title><link href="/stylesheets/dist/normalize.css" rel="stylesheet" /><link href="/stylesheets/dist/skeleton.css" rel="stylesheet" /><link href="/stylesheets/all.css" rel="stylesheet" /><script src="/javascripts/all.js"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="index"><div class="header"><div class="header-title"><h1><a href="/">ukstudio</a></h1></div></div><div class="container"><article><h1 class="article-title"><a href="/2015/06/15/ux_introduction/">UX概論に参加した</a></h1><div class="article-time"><time dateMime="2015-06-15 12:32:00 UTC" pubdate="pubdate">June 15 2015</time></div><div class="article-body"><p><a href="https://atnd.org/events/66918">【満席のため受付終了】UX概論　〜UXデザインの基礎を学ぶ勉強会〜 : ATND</a></p>

<p>この間の土曜日に参加してきた。ミニワークショップいれて3時間弱の勉強会だったけど、思ってた以上にUXに対する知識が浅かったなぁと通関した。すごく勉強になりました。講師の浅野先生、運営の倉光さん、その他スタッフのみなさん、本当にありがとうございます。</p>

<p>勉強会の内容だけど、UX自体はそんなにおおごとじゃないけど、じゃあどうやってそれを実現するの(つまりUXデザインの部分)ってなるとかなり大変そうだなぁという印象を受けました。ペルソナからしてちょっと甘くみてた感じです。</p>

<p>今後の課題としては社内のプロジェクト(とりあえず自分のチームだけでも)にUXデザインをどう取り込むかかなぁ。講師の方にアドバイスもらったけど外部の専門家でも雇って一緒にやって覚えるというのがよさそう。あとはいくつかの会社合同でワークショップをやるといいみたいな話もあったのでどこかのタイミングでやれたらな。</p>

<p>がんばるぞい</p>
</div></article><article><h1 class="article-title"><a href="/2015/04/19/follow-update-of-gem/">特定のGemの更新情報を追う</a></h1><div class="article-time"><time dateMime="2015-04-19 15:20:00 UTC" pubdate="pubdate">April 19 2015</time></div><div class="article-body"><p>コード自体を追うなら大体GitHubで事足りるけど、Gemがリリースされたのを追いたいときにはRubyGems.orgのSubscribe使えばよさそうだったのでメモ。</p>

<p><img src="/images/2015-04-20-follow-update-of-gem-01.png" alt="Click subscribe link" /></p>

<p>RubyGems.orgの適当なGemのページを開くと右下の方にSubscribeというリンクがある。このリンクをクリックするとDashboardにそのGemの更新情報が表示される。あとはそこに表示されているRSSを追えばOK。</p>

<p><img src="/images/2015-04-20-follow-update-of-gem-02.png" alt="Get dashboard's rss" /></p>
</div></article><article><h1 class="article-title"><a href="/2015/04/10/the_year_without_pants/">「マイクロソフトを辞めて、オフィスのない会社で働いてみた」読了した</a></h1><div class="article-time"><time dateMime="2015-04-10 05:08:00 UTC" pubdate="pubdate">April 10 2015</time></div><div class="article-body"><p><a href="http://www.amazon.co.jp/gp/product/4105068318?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=4105068318&amp;linkCode=shr&amp;tag=ukstudio0c-22&amp;qid=1428640468&amp;sr=8-1&amp;keywords=%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E3%82%92%E8%BE%9E%E3%82%81%E3%81%A6+%E3%82%AA%E3%83%95%E3%82%A3%E3%82%B9%E3%81%AE%E3%81%AA%E3%81%84%E4%BC%9A%E7%A4%BE%E3%81%A7%E5%83%8D%E3%81%84%E3%81%A6%E3%81%BF%E3%81%9F">Amazon.co.jp： マイクロソフトを辞めて、オフィスのない会社で働いてみた: スコット・バークン, 依田卓巳: 本</a></p>

<p>会社で買ってもらった本読み終わった。おもしろかったのでサクサク読んだ。おすすめ。</p>

<p>この本はマイクロソフトでプロジェクトマネージャーをやっていて、現在経営コンサルのスコット・バークンが社員全員がリモート勤務しているオートマティック社(wordpress.com作ってるところ)に勤務したときの話が書かれてる。所謂ドキュメンタリーに近いのだけど、誰かが観察したとかではなくて実際に著者が働いた時の体験がベースになってる。</p>

<p>37signalsの「強いチームはオフィスを捨てる」もまぁそんなにつまらなくはなかったけどなんかキレイ事だけっぽい感じがするのと対象に、こっちは良かったこと悪いこと両方について書かれていて色々考えさせられる。強いチームはオフィスを捨てるより色々参考になるのでリモートに興味がある人は読むといいかも。</p>

<p>スコットのすごいところは今までチームという文化が全然なかったところに(締め切りもないし見積りもない)、チームという文化を導入して実績を残したところ。著者が言うように、ある文化で染まっているところに新しい文化を導入するのはそう簡単なことじゃない。</p>

<p>それとリモートはやっぱり難しいなというのが率直な感想で、今のメンバーを散り散りに働かしても多分成果は落ちる。スコットも作中で「リモートでも良い仕事ができたが、いつもそばにいれたらもっと良い仕事ができたと思う」みたいなことを言っていた。逆にオートマティックのCEOは全員リモートがとてもよい働き方だとも思っているらしい(成果より社員の満足度・幸福度を軸に考えているのかも)</p>

<p>じゃあなんでリモートするのかというと、居住地に縛られず人を雇えるのが大きいのかなと思う。例えばちょーやばいハッカーがいるけど俺はカリフォルニアから出る気がないぜ、という人だと東京で当然雇えないがリモートだったら雇える可能性がある。つまり距離という制限をなくして本当に働きたい人と働くことができる。</p>

<p>あとはやっぱりリモートで時間に縛られないことで社員の満足度があがるとか(自分の好きなところで働きたい、子供の世話を見なくてはいけない…etc)についても言及されていて、ここらへんはなんとなく感じている通りかなという印象。</p>

<p>この本はオートマティック社がフルリモートでどう仕事しているのかというのもおもしろいが、それ以上にスコットがカオスな会社にチームという文化を導入するまでの流れの方がおもしろいかな。おすすめです。</p>
</div></article><article><h1 class="article-title"><a href="/2015/04/03/gihyo_scrum_book/">スクラム実践入門読み終わった</a></h1><div class="article-time"><time dateMime="2015-04-03 17:22:00 UTC" pubdate="pubdate">April 03 2015</time></div><div class="article-body"><p><a href="http://www.amazon.co.jp/gp/product/4774172367?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=4774172367&amp;linkCode=shr&amp;tag=ukstudio0c-22&amp;qid=1428081771&amp;sr=8-1&amp;keywords=%E3%82%B9%E3%82%AF%E3%83%A9%E3%83%A0%E5%AE%9F%E8%B7%B5%E5%85%A5%E9%96%80">Amazon.co.jp： スクラム実践入門 ── 成果を生み出すアジャイルな開発プロセス (WEB+DB PRESS plus): 貝瀬 岳志, 原田 勝信, 和島 史典, 栗林 健太郎, 柴田 博志, 家永 英治: 本</a></p>

<p>2015/4/3に読了。</p>

<p>会社で購入してもらったのでざっと読み終えた。</p>

<h2>ソフトウェアはどこにあるのか。そう、僕らの心のなかにあるんだよ…</h2>

<p>なんかふざけた見出しつけたけど、1章は結構好きで何回か読み直したいなという章だった。スクラムについて知るぞ〜と意気込む若者がよんだらちょっとびっくりするかもしれない。それでもまずは読んでみて自分なりに考えてほしいなぁと思う。僕もまだちょっと消化不良感あるので消化したい。</p>

<h2>スクラムガイドのガイド</h2>

<p>2〜4章はスクラムガイドに基いてスクラムについてコンパクトに解説してくれる。この辺はスクラムについてある程度知識はあったのでうんうんという感じで読みました。</p>

<p>正直、スクラムガイドってあれだけ読んでもピンと来ない人ってそこそこいると思うんだよね。スクラムガイドだけじゃいまいちわからんって人はこれらの章を読むとある程度理解できると思う。</p>

<h2>各社の事例と問題解決の道標。</h2>

<p>この本でしか読めないと噂の6〜8章。それと問題とその解決策を提示してくれる9〜12章。</p>

<p>この辺りの章もよかった。特に僕の場合、日々の開発でなにかしらうまくいかないことがあってそれの答えとまではいかなくとも参考になるなにかが欲しいという動機でこの本を買ってもらったのですごく参考になった。</p>

<h2>理論の前半、現場の後半</h2>

<p>前半と後半でそれぞれ読み応えがあるので、スクラムについて全然しらんという人でもスクラムについてある程度知ってたり経験があるっていう人でもなにかしら得るものがある本だなと思いました。</p>

<p>弊社でも1人、悩める人がいるのでその人には是非読んでもらおうかなと思います。</p>
</div></article><article><h1 class="article-title"><a href="/2015/03/26/open_pull_request/">特定のコミットが含まれるGitHub Pull Requestを開く</a></h1><div class="article-time"><time dateMime="2015-03-26 12:18:00 UTC" pubdate="pubdate">March 26 2015</time></div><div class="article-body"><p>今日たまたまあるコミットが含まれているGitHubのPull Requestをサクッと探したい事案が発生した。というのも自分が以前書いたコードがどうしてこうなっているのかというのを知りたかったんだけど、commit messageだけじゃよくわからんかった(〜を実装したみたいなことを英語で書いてあっただけ)。</p>

<p>Pull Requestは割と丁寧に説明を書いているのできっとPull Requestのdescriptionを見ればわかりそうという感じはしたのだけれどパッとそれを開く手段がわからず、色々ググったりtwitterで教えてもらったりした結果下のようなfunctionをzshrcに書いた。</p>
<pre class="highlight shell"><code><span class="k">function </span>find-pr<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">parent</span><span class="o">=</span><span class="nv">$2</span><span class="o">||</span><span class="s1">'master'</span>
  git log <span class="nv">$1</span>..<span class="nv">$2</span> --merges --ancestry-path --reverse --oneline | head -n1
<span class="o">}</span>

<span class="k">function </span>find-pr-open<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">pr</span><span class="o">=</span><span class="s2">"</span><span class="k">$(</span>find-pr <span class="nv">$1</span> <span class="nv">$2</span> | awk <span class="s1">'{print substr($5, 2)}'</span><span class="k">)</span><span class="s2">"</span>
  <span class="nb">local </span><span class="nv">repo</span><span class="o">=</span><span class="s2">"</span><span class="k">$(</span>git config --get remote.origin.url | sed <span class="s1">'s/git@github.com://'</span> | sed <span class="s1">'s/\.git$//'</span><span class="k">)</span><span class="s2">"</span>
  open <span class="s2">"https://github.com/</span><span class="k">${</span><span class="nv">repo</span><span class="k">}</span><span class="s2">/pull/</span><span class="k">${</span><span class="nv">pr</span><span class="k">}</span><span class="s2">"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight plaintext"><code>find-pr-open REVISION
</code></pre>

<p>あまりシェルは得意ではないのでそこらへんは大目に見て欲しい。やってることはfind-prで該当のcommitが含まれているMerge commitを探してcommit messageからGitHub Pull Requestの番号を取り出している。リポジトリ名はgit configから取得して余計な文字はsedで削除。あとはURLを組み立ててブラウザで開くだけ。多分これでPull Requestを開けるはず。</p>

<p>なんにせよcommit messageはもうちょっと丁寧に書こうと思いました。</p>
</div></article><article><h1 class="article-title"><a href="/2015/03/20/vuejs/">Vue.js便利</a></h1><div class="article-time"><time dateMime="2015-03-20 20:20:00 UTC" pubdate="pubdate">March 20 2015</time></div><div class="article-body"><p>今のプロダクトにちょっと前からVue.jsを採用しているんだけど、少しずつうまく使えるようになってきていてすごく便利だなーと感じる。コンポーネントについても大体わかってきた。</p>

<p>RailsアプリケーションにVue.jsを採用してどう変えてきたかみたいな記事をそのうち <a href="http://blog.spicelife.jp/">スパイスな人生</a> の方に投稿したいと思う。お楽しみに。</p>
</div></article><article><h1 class="article-title"><a href="/2015/01/29/tex_yoda/">TEX Yodaが届いたので使い始めた</a></h1><div class="article-time"><time dateMime="2015-01-29 10:54:00 UTC" pubdate="pubdate">January 29 2015</time></div><div class="article-body"><p><a href="https://www.massdrop.com/buy/tex-yoda?mode=guest_open">TEX Yoda TrackPoint Keyboard - Massdrop</a></p>

<p>一部で話題のTEX Yodaが先週の金曜日に届いたので今週から使っている。</p>

<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="4" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:250px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div> <p style=" margin:8px 0 0 0; padding:0 4px;"> <a href="https://instagram.com/p/yUmhN8xXLR/" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_top">とりあえずできた</a></p> <p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">AKAMATSU Yukiさん(@ukstudio)が投稿した写真 - <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2015-01-26T15:18:07+00:00">2015 1月 26 7:18午前 PST</time></p></div></blockquote>

<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

<h2>ハンダ付け</h2>

<p>久々のハンダ付けだけど、MXスイッチの足と基板をつけるだけだし、オフィスに<a href="http://asonas.hatenablog.com/entry/2015/01/24/173920">先に組み立て済みの同僚</a>もいたのでそんなに難しいこともなく終了。といっても幾つかミスもあったわけだけど。</p>

<ul>
<li>LEDを付ける前に基板をネジ止めした</li>
<li>ハンダ付けしわすれた箇所があった</li>
</ul>

<p>TEX YodaにはLEDつけるところがあるんだけど、そのLEDがキートップのパーツと同じ袋に入ってる。なので基板にひと通りスイッチつけて、満足してネジ止めして「さー、キートップつけるぞ」と思い袋あけるとそこからLEDがでてきて悲しい感じになる。ハンダ付けするときにLEDの話を同僚としていたのにこれだよ。</p>

<p>ハンダ付けしわすれたのは完全に自分のミス。ひと通り組み立て終わったあとに0のキーが効かず、ハンダ付けのときに基板壊したかなとすごい焦ったけど開けてみたら普通にハンダがついてなかったというオチ。ちなみに現状、左下のFnキーも動いてないのでそこも忘れてる可能性ある。</p>

<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="4" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:250px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div> <p style=" margin:8px 0 0 0; padding:0 4px;"> <a href="https://instagram.com/p/yV0z5CxXIt/" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_top">ゼロのキー動かんと思ったらこれですよ</a></p> <p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">AKAMATSU Yukiさん(@ukstudio)が投稿した写真 - <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2015-01-27T02:42:15+00:00">2015 1月 26 6:42午後 PST</time></p></div></blockquote>

<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

<h2>選んだ軸</h2>

<p>実は買って届くまでMXスイッチの軸の色の意味を知らなかったんだけど、買うときに一番値段が高かったクリア軸にした。わからないときはとりあえず高いのにしておく精神。調べてみると茶軸に近い感じということらしい。茶軸使ったことないからそう言われてもわからないけど…。他にも色々な軸があるので試してみたい気がする。緑とか気になる。</p>

<h2>ちょっとしたカスタマイズ</h2>

<p>MXスイッチ互換のキートップが売ってたりするので適当に変えてみたりした。PCゲーマーではおなじみのWASD。あとIJKLを赤に。これらはFnを押すとカーソルキーの動きをしてくれる。あとはなんとなくスペースも赤にしたら顔みたいになった。</p>

<blockquote class="instagram-media" data-instgrm-captioned data-instgrm-version="4" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:250px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div> <p style=" margin:8px 0 0 0; padding:0 4px;"> <a href="https://instagram.com/p/yY9zPMxXH1/" style=" color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;" target="_top">顔っぽい</a></p> <p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;">AKAMATSU Yukiさん(@ukstudio)が投稿した写真 - <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2015-01-28T07:58:31+00:00">2015 1月 27 11:58午後 PST</time></p></div></blockquote>

<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

<h2>キーレイアウト</h2>

<p>現時点のレイアウトはDIPスイッチの１，３，５がオフ、２，４，６がオンになっている。それぞれの意味はマニュアル参照。</p>

<p><a href="https://docs.google.com/file/d/0B7TuRf3KQe7GdjJwNXMwdHZIUm8/edit">TKB-600i-Datasheet_14-0603-Rev 1.0.pdf - Google ドライブ</a></p>

<p>大体よくあるレイアウトだとは思うけど、珍しいのはESCと`~が同じキーでどちらかをFnキー押しながらじゃないと入力できない(DIPスイッチの3番参照)。</p>

<p>最初は普通に入力したらESCにして`~をFnキー押すようにしていたのだけど~がShiftも押さなきゃいけないのがあまりに不便すぎてやめた。VimmerとしてはESCはコード書くときそんなに使わないし、普段もMacユーザーなのでKarabinerでctrl-[をESC扱いにするようにしてESC単体で押す必要をなくして無事解決。</p>

<h2>総評</h2>

<p>概ね使い心地には満足している。元々ThinkPad使っていたのでトラックポイントも違和感なく、机からマウスを排除できたし、むしろマウスのためだけに腕を動かさなくなったが大分よい。実はHHKで一番気に入らなかったのがDELETEの位置で、TEX Yodaではそこが\になったのも良い。</p>

<p>本体の重さがそれなりにある。その気になれば撲殺できそうな程度には。なので持ち歩くつもりでいるならHHKの方がよいかなと思う。俺はあまりキーボードを持ち歩く人間ではないので問題ない。</p>

<p>タッチ感だけど、音はクリア軸のせいかTEX Yodaがそうなのかわからないけど、ちょっとちゃっちい音のような気もする。クリック感は個人的には大分気に入っていて、HHK、KinesisとTEX Yoda(クリア軸)だったらTEX Yodaが一番好み。ちなみにAlphaGripは俺の中では黒歴史化している。</p>

<p>今massdropをみると$199までもうちょいなので、興味ある人は買っていきましょう。ハンダ付けも$25でやってくれる模様。買って損はしないキーボードだと思います。実物みないと…という人は弊社に2つあるので遊びにくるとよいですよ。</p>
</div></article><article><h1 class="article-title"><a href="/2015/01/01/joined_spicelife/">株式会社spice lifeに入社しました</a></h1><div class="article-time"><time dateMime="2015-01-01 01:01:00 UTC" pubdate="pubdate">January 01 2015</time></div><div class="article-body"><p>あけましておめでとうございます。今年もどうぞよろしくお願いいたします。</p>

<p>さて、タイトル通りではありますが、<strong>本日2015年1月1日から株式会社spice lifeに入社しました</strong>。社員です。</p>

<blockquote style='text-align: center' class="twitter-tweet" lang="en"><p>入社</p>&mdash; ゆーけー/赤松 祐希 (@ukstudio) <a href="https://twitter.com/ukstudio/status/550306578851569668">December 31, 2014</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>なので2010年(だったかな)から続いていたフリーランス業も一旦終わりになります。フリーランスの時には様々な人にお世話になりました。本当に感謝の言葉しかでてきません。一部の方々にはご迷惑をお掛けしてしまったこともあります。本来直接伝えることなのでしょうがここで簡単にでもお詫びと感謝の気持ちを述べさせてください。本当にありがとうございました。</p>

<p>spice lifeには6月の終わり頃からフリーランスとして契約させてもらっていてとりあえず半年契約しましょう、その後はその半年働いてよかったら再契約しましょう、という感じでした。ところがどっこい、再契約どころか正式に入社という運びとなりました。元々社員に近い形で働いていたので働き方的にはあまり大きく変わりはしませんが、4年程度フリーランスをしていたのでちょっと感慨深くあります。</p>

<p>ここ最近はリリースの時にもこのブログで<a href="/2014/11/27/spotlights-jp/">お知らせ</a>した<a href="https://spotlights.jp/">SPOTLIGHTS</a>というサービスの開発に携わっています。もうしばらく携わっていく予定ですので何卒よろしくおねがいします。</p>

<p><a href="http://amzn.to/ukstudio">ｳｨｯｽﾘｽﾄ</a></p>
</div></article><article><h1 class="article-title"><a href="/2014/12/14/esa_flow_stock/">esaのストックとフローの絞り込みで(俺にとって)なにがうれしいのか</a></h1><div class="article-time"><time dateMime="2014-12-14 07:50:00 UTC" pubdate="pubdate">December 14 2014</time></div><div class="article-body"><p>そもそもesaのストックとフローの絞り込みってなに？っていう人は以下のリンクからどうぞ。</p>

<p><a href="https://docs.esa.io/posts/31">release_note/2014/12/13/検索結果の絞り込み(Stock or Flow) - docs - esa.io</a></p>

<p>簡単に説明するとesaではカテゴリに日付が入っている記事はフロー、入っていない記事はストックとして扱いそれらを分けて検索できるようになった。</p>

<h2>結論から</h2>

<p>たまには長い話をすっとばして結論を書く。簡単に言ってしまうと</p>

<ul>
<li>yy年mm月dd日にAの仕様を変更したよ</li>
<li>現時点において最新の仕様はこうです</li>
</ul>

<p>という2種類の情報を前者はフロー、後者はストックとして分けて検索できるようになった。大体においてほしい情報というのは後者のストックなので個人的には非常にうれしい。</p>

<h2>そもそもストックとフローとは</h2>

<p>記事自体にストックとフローという概念をもたせるのは実はあまり新しい話でもなく、「wiki ブログ ストック フロー」で検索するとそれなりに記事がでてくる。要はwiki=ストック、ブログ=フローということだ。もちろん、wikiのあるページにフローの概念をもたせることもブログのある記事にストックの概念をもたせることも可能だけど大枠としてそういうことにする。<a href="http://jkondo.hatenablog.com/entry/2011/11/19/114109">ブログもストックっていう人もいるけど</a>、wikiとかブログとかはここではあまり重要ではないので置いておく。</p>

<p>僕の捉え方でいうと、時系列にそって情報の流れがあるものはフロー、累積されていくようなものはストックと考えている(これなんの説明にもなっていないのでは…)</p>

<h2>議事録はフロー</h2>

<p>esaでそれなりの量の議事録を書いてきたけど、これらはMTGの日付をカテゴリに入れているのでフローだ。これらは日々の仕様の変更の流れをそのまま現しているのでフローとして扱うのは妥当だと思う。</p>

<p><img src="/images/2014-12-14-flow.png" alt="flow.png" /></p>

<p>こういった情報がフローだけだと困ることがある。議事録には変更の差分しか書かれていない。なので現時点であるべき仕様を議事録から読み解くのは大変だ。エンジニアにわかるようにいうとgitの各commitのdiffから現在のソースコードを想像しろというものだ。</p>

<h2>そこでストック</h2>

<p>つまり、フローである議事録とは別に今あるべき姿を累積する記事が必要になる。そこでesa上では日付の入っていない記事を作り、そこにあるべき姿を書いていく。重要なのはフローと違いストックはその記事をちゃんと更新する必要があるということだ。</p>

<p>今まではこういう風にフローとストックの記事を分けてもうまく検索することができずにREADME.mdにリンクを貼っておくということしかできなかった。なのでそもそも人の目につかず、結果更新もされないという感じだったけれど、検索しやすくなったことで情報が古いことが目につきやすくなるので自然と更新も行われやすくなるのではないかと思う(みんな更新してね!)</p>

<h2>おまけ</h2>

<p>そもそも仕様をesaに書くの?みたいな話ありそうだけど、実装の前にメンバーに仕様を共有するケースはそれなりにあるし、コードを読んでもWhyがわからないのでなぜこうしたのかみたいな部分はドキュメントに残したりもする。</p>

<p>それに今回は仕様の話を例にとったけど、例えばインフラまわりだと議事録でこういう構成にしたという話を残すのとは別に構成がかわったことによってデプロイ手順もかわったならそれはストックとして残したいという話もある。</p>
</div></article><article><h1 class="article-title"><a href="/2014/11/27/spotlights-jp/">spotlights.jpが本日10時にリリースされました</a></h1><div class="article-time"><time dateMime="2014-11-27 07:33:00 UTC" pubdate="pubdate">November 27 2014</time></div><div class="article-body"><p><a class="embedly-card" href="https://spotlights.jp">みんなで贈るソーシャルギフト・プレゼント ＼SPOTLIGHTS／（スポットライト）</a>
<script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script></p>

<div style="text-align: center">
  <iframe width="560" height="315" src="//www.youtube.com/embed/xP14KD2qIR8" frameborder="0" allowfullscreen></iframe>
</div>

<p>今日の10時より<a href="http://spicelife.jp/">株式会社spice life（スパイスライフ）</a>からSPOTLIGHTSがリリースされました!!</p>

<p>ここ2ヶ月弱の追い込みにプログラマとして開発に関わらせて頂いてます(今後も関わっていく予定です)。実は自分のブログで関わってます！って言えるサービスは初めてだと思うので、期間はまだ短いですがちょっと感慨深いものがあります。</p>

<p>結婚式や誕生日のお祝いや日頃の感謝などにご活用ください。</p>
</div></article><article><h1 class="article-title"><a href="/2014/09/21/rspec_power_assert/">RSpecでPower Assertをやるには</a></h1><div class="article-time"><time dateMime="2014-09-21 06:12:00 UTC" pubdate="pubdate">September 21 2014</time></div><div class="article-body"><p>RubyKaigi 2014でpower assertの話を聞いてrspecでどうにかならんかちょっと考えてみました。まず結論だけ書くとrspecでpower assertを使いたければ以下の様に書けばOK。</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'rspec'</span>
<span class="nb">require</span> <span class="s1">'minitest'</span>
<span class="nb">require</span> <span class="s1">'minitest-power_assert'</span>

<span class="k">module</span> <span class="nn">Minitest</span>
  <span class="k">module</span> <span class="nn">Assertions</span>
    <span class="n">prepend</span>  <span class="no">Minitest</span><span class="o">::</span><span class="no">PowerAssert</span><span class="o">::</span><span class="no">Assertions</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">expect_with</span> <span class="ss">:minitest</span>
<span class="k">end</span>

<span class="n">describe</span> <span class="s1">'Test'</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">'test'</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">{</span> <span class="mi">1</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">class</span> <span class="o">==</span> <span class="mi">1</span><span class="p">.</span><span class="nf">to_i</span><span class="p">.</span><span class="nf">class</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>これを</p>
<pre class="highlight shell"><code><span class="gp">$ </span>rspec --color -rpower_assert power_assert.rb
</code></pre>

<p>で実行するとこんな感じ。power_assertは事前にrequireした方が情報量がちょっと増える。</p>
<pre class="highlight plaintext"><code>Failures:

  1) Test test
     Failure/Error: assert { 1.to_s.class == 1.to_i.class }
     Minitest::Assertion:

           assert { 1.to_s.class == 1.to_i.class }
                      |    |     |    |    |
                      |    |     |    |    Fixnum
                      |    |     |    1
                      |    |     false
                      |    String
                      "1"
</code></pre>

<h2>letとsubject</h2>

<p>power<em>assertの0.1.3だとdefined</em>methodで定義されたメソッドの値が取れていないらしく、letやsubjectの値が表示されない。現時点でのmasterの0.1.4devだと修正されているとのことなのでちゃんと表示される。</p>
<pre class="highlight ruby"><code><span class="n">describe</span> <span class="s1">'Test'</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:klass</span><span class="p">)</span> <span class="p">{</span> <span class="mi">1</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">class</span> <span class="p">}</span>
  <span class="n">it</span> <span class="s1">'test'</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">{</span> <span class="n">klass</span> <span class="o">==</span> <span class="mi">1</span><span class="p">.</span><span class="nf">to_i</span><span class="p">.</span><span class="nf">class</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>これを実行すると</p>
<pre class="highlight plaintext"><code>Failures:

  1) Test test
     Failure/Error: assert { klass == 1.to_i.class }
     Minitest::Assertion:

           assert { klass == 1.to_i.class }
                    |     |    |    |
                    |     |    |    Fixnum
                    |     |    1
                    |     false
                    String
</code></pre>

<p>こんな感じ。subjectも大体おなじ。</p>

<h2>expectとマッチャ</h2>

<p>この方法はMinitestのadapterとminitest-power_assertを使うようにしているので無理。</p>

<p>ちなみに <a href="https://gist.github.com/mizoR/3cf068eeae033bd5db5a">rspec で 手軽に power_assert 出力できるようにする</a> の方法でexpectを使ってみると</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'rspec/core'</span>
<span class="nb">require</span> <span class="s1">'power_assert'</span>

<span class="k">module</span> <span class="nn">RSpec</span>
  <span class="k">module</span> <span class="nn">PowerAssert</span>
    <span class="k">def</span> <span class="nf">power_assert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
      <span class="o">::</span><span class="no">PowerAssert</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pa</span><span class="o">|</span>
        <span class="k">begin</span>
          <span class="n">pa</span><span class="p">.</span><span class="nf">yield</span>
        <span class="k">rescue</span> <span class="no">RSpec</span><span class="o">::</span><span class="no">Expectations</span><span class="o">::</span><span class="no">ExpectationNotMetError</span> <span class="o">=&gt;</span> <span class="n">e</span>
          <span class="n">e</span><span class="p">.</span><span class="nf">message</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">PowerAssert:</span><span class="se">\n</span><span class="si">#{</span><span class="n">pa</span><span class="p">.</span><span class="nf">message_proc</span><span class="p">.</span><span class="nf">call</span><span class="si">}</span><span class="s2">"</span>
          <span class="k">raise</span> <span class="n">e</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">RSpec</span><span class="o">::</span><span class="no">Core</span><span class="o">::</span><span class="no">ExampleGroup</span>
  <span class="kp">include</span> <span class="no">RSpec</span><span class="o">::</span><span class="no">PowerAssert</span>
<span class="k">end</span>

<span class="n">describe</span> <span class="s1">'Test'</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">'test'</span> <span class="k">do</span>
    <span class="n">power_assert</span> <span class="p">{</span>
      <span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">class</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="nf">to_i</span><span class="p">.</span><span class="nf">class</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>これは</p>
<pre class="highlight plaintext"><code>       PowerAssert:
             expect(1.to_s.class).to eq(1.to_i.class)
             |        |    |      |  |    |    |
             |        |    |      |  |    |    Fixnum
             |        |    |      |  |    1
             |        |    |      |  #&lt;RSpec::Matchers::BuiltIn::Eq:0x007f0850c91d78 @expected=Fixnum, @actual=String&gt;
             |        |    |      nil
             |        |    String
             |        "1"
             #&lt;RSpec::Expectations::ExpectationTarget:0x007f0850caa170 @target=String&gt;

</code></pre>

<p>こうなってしまう。この場合、expectの@targetにStringという結果が入っているのでそれを取り出すようにして、eqの方も@expectedに期待するものがはいってるのでそれを取りだすようにすればいいのかなぁ。</p>

<p>もしくはexpectとeqの中の値さえわかれば良いといえば良いのでいっそ値をださなくてもいいのかも? 例えばこんな感じ。</p>
<pre class="highlight plaintext"><code>       PowerAssert:
             expect(1.to_s.class).to eq(1.to_i.class)
                      |    |              |    |
                      |    |              |    Fixnum
                      |    |              1
                      |    |
                      |    |
                      |    String
                     "1"


</code></pre>

<p>別の例としてbe_falseyだとこんな感じ。</p>
<pre class="highlight plaintext"><code>     Failure/Error: expect(nil.to_s.to_i).to be_falsey
       expected: falsey value
            got: 0
       PowerAssert:
             expect(nil.to_s.to_i).to be_falsey
             |          |    |     |  |
             |          |    |     |  #&lt;RSpec::Matchers::BuiltIn::BeFalsey:0x007fa84b53bb00 @actual=0&gt;
             |          |    |     nil
             |          |    0
             |          ""
             #&lt;RSpec::Expectations::ExpectationTarget:0x007fa84b3e02b0 @target=0&gt;
</code></pre>

<p>これに関していうとbe<em>falseyにはfalseが欲しいという情報がない。be</em>falseyを見れば求めてるものはわかるって話かもしれないけど… 更に言うとRSpec3でComposable Matcherが入ったりとか、以前からあるCustom Matcherとかがあったりして、それら全部対応するのは厳しいなーという感じ(そもそも対応できるのかもよくわからない…)</p>

<p>そもそもの話をするとそういったマッチャというか、たくさんあるassertion methodを使い分けしたくないからpower assertをつかうわけで別にマッチャとか使わなくていいのではという気持ちがある。</p>

<p>なのでexpectとかカスタムマッチャとかは(power assertを使う部分では)諦めてassertですませるのがよさそうかなと個人的には思う。</p>
<pre class="highlight ruby"><code><span class="n">config</span><span class="p">.</span><span class="nf">expect_with</span> <span class="ss">:minitest</span>
<span class="n">config</span><span class="p">.</span><span class="nf">expect_with</span> <span class="ss">:rspec</span>
</code></pre>

<p>spec<em>helper.rbにminitestもrspecも両方使うよう書けばpower</em>assertを使いたいところと、rspecを使いたいところで分けることができるのでどうしてもマッチャを使いたいところは素直にマッチャを書いてpower assertは諦めるしかない。</p>

<p>今あるテスト資産をそのまんまpower assert対応にはできないのが悲しいところではあるけれども、このassertを使う方法でもexpectation部分以外はrspecの機能そのまま使えるのでそこまで悪くはないかなと思う。</p>

<p>まだpower_assert gemの実装を理解できていないので、もしかしたらうまいことやれるかもしれないけどとりあえずここでギブアップ…</p>
</div></article><article><h1 class="article-title"><a href="/2014/09/05/arel/">Arelあれこれ</a></h1><div class="article-time"><time dateMime="2014-09-05 08:51:00 UTC" pubdate="pubdate">September 05 2014</time></div><div class="article-body"><h2>Model.arel_table を読みづらいと感じる</h2>

<p>例えばこういうコード。</p>
<pre class="highlight ruby"><code><span class="no">Post</span><span class="p">.</span><span class="nf">joins</span><span class="p">(</span><span class="ss">:comments</span><span class="p">).</span><span class="nf">order</span><span class="p">(</span><span class="no">Comment</span><span class="p">.</span><span class="nf">arel_table</span><span class="p">[</span><span class="ss">:created_at</span><span class="p">].</span><span class="nf">desc</span><span class="p">)</span>
</code></pre>

<p>発行されるSQLはこんな感じ。</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"comments"</span> <span class="k">ON</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"created_at"</span> <span class="k">DESC</span>
</code></pre>

<p>こちらの方が個人的には読みやすい。</p>
<pre class="highlight ruby"><code><span class="no">Post</span><span class="p">.</span><span class="nf">joins</span><span class="p">(</span><span class="ss">:comments</span><span class="p">).</span><span class="nf">order</span><span class="p">(</span><span class="s1">'comments.created_at desc'</span><span class="p">)</span>
</code></pre>

<h2>問題もある</h2>

<h3>テーブル名を変えてしまったとき</h3>

<p>仮にテーブル名がかわったら後者の場合はエラーになる。</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"new_comments"</span> <span class="k">ON</span> <span class="nv">"new_comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">comments</span><span class="p">.</span><span class="n">created_at</span> <span class="k">DESC</span>
<span class="n">SQLite3</span><span class="p">::</span><span class="k">SQLException</span><span class="p">:</span> <span class="k">no</span> <span class="n">such</span> <span class="k">column</span><span class="p">:</span> <span class="n">comments</span><span class="p">.</span><span class="n">created_at</span><span class="p">:</span> <span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"new_comments"</span> <span class="k">ON</span> <span class="nv">"new_comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">comments</span><span class="p">.</span><span class="n">created_at</span> <span class="n">D</span>
<span class="n">ESC</span>
<span class="n">ActiveRecord</span><span class="p">::</span><span class="n">StatementInvalid</span><span class="p">:</span> <span class="n">SQLite3</span><span class="p">::</span><span class="k">SQLException</span><span class="p">:</span> <span class="k">no</span> <span class="n">such</span> <span class="k">column</span><span class="p">:</span> <span class="n">comments</span><span class="p">.</span><span class="n">created_at</span><span class="p">:</span> <span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"new_comments"</span> <span class="k">ON</span> <span class="nv">"new_comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span>
  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">comments</span><span class="p">.</span><span class="n">created_at</span> <span class="k">DESC</span>

</code></pre>

<p>前者はモデルの方でテーブル名を変更すれば動作する。</p>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">table_name</span>  <span class="ss">:new_comments</span>
<span class="k">end</span>
</code></pre>

<h3>scopeでmergeしたいとき</h3>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">scope</span> <span class="ss">:recent</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="s1">'created_at &gt; ?'</span><span class="p">,</span> <span class="mi">10</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>

<span class="no">Post</span><span class="p">.</span><span class="nf">joins</span><span class="p">(</span><span class="ss">:comments</span><span class="p">).</span><span class="nf">merge</span><span class="p">(</span><span class="no">Comment</span><span class="p">.</span><span class="nf">recent</span><span class="p">)</span>
</code></pre>

<p>これだとCommentのcreated_atが解決できなくてコケる。</p>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"comments"</span> <span class="k">ON</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">created_at</span> <span class="o">&gt;</span> <span class="s1">'2014-08-26 09:16:45.106691'</span><span class="p">)</span>
<span class="n">SQLite3</span><span class="p">::</span><span class="k">SQLException</span><span class="p">:</span> <span class="n">ambiguous</span> <span class="k">column</span> <span class="n">name</span><span class="p">:</span> <span class="n">created_at</span><span class="p">:</span> <span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"comments"</span> <span class="k">ON</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">created_at</span> <span class="o">&gt;</span> <span class="s1">'2014-08-26 09:16:45.
106691'</span><span class="p">)</span>
<span class="n">ActiveRecord</span><span class="p">::</span><span class="n">StatementInvalid</span><span class="p">:</span> <span class="n">SQLite3</span><span class="p">::</span><span class="k">SQLException</span><span class="p">:</span> <span class="n">ambiguous</span> <span class="k">column</span> <span class="n">name</span><span class="p">:</span> <span class="n">created_at</span><span class="p">:</span> <span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"comments"</span> <span class="k">ON</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">cr</span>
<span class="n">eated_at</span> <span class="o">&gt;</span> <span class="s1">'2014-08-26 09:16:45.106691'</span><span class="p">)</span>
</code></pre>

<p>正しくはこう。</p>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">scope</span> <span class="ss">:recent</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="nf">arel_table</span><span class="p">[</span><span class="ss">:created_at</span><span class="p">].</span><span class="nf">gt</span><span class="p">(</span><span class="mi">10</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">))</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight sql"><code><span class="k">SELECT</span> <span class="nv">"posts"</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="nv">"posts"</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="nv">"comments"</span> <span class="k">ON</span> <span class="nv">"comments"</span><span class="p">.</span><span class="nv">"post_id"</span> <span class="o">=</span> <span class="nv">"posts"</span><span class="p">.</span><span class="nv">"id"</span> <span class="k">WHERE</span> <span class="p">(</span><span class="nv">"comments"</span><span class="p">.</span><span class="nv">"created_at"</span> <span class="o">&gt;</span> <span class="s1">'2014-08-26 09:19:17.406299'</span><span class="p">)</span>
</code></pre>

<h2>僕個人の結論</h2>

<p>Model.arel_tableはできる限り隠したい(読みづらいから)。そしてmergeを使いたいケースではArelを使っておく。その変わりmergeが必要になるまでは無理にArelを使わない。</p>

<p>さっきのComment#recentの例でいうなら最初は<code>where(&#39;created_at &gt; ?&#39;, 10.days.ago)</code>で書いておく。merged使いたい時になったらArelの方で書き直す。</p>

<p>テーブル名の変更のリスクは気にしない。そもそもあまりテーブル変更しないし…。既にあるDBの上にRailsアプリケーションを構築する場合はDBリファクタリングのことを考えてArel使いまくった方がいいのかもしれない。</p>
</div></article><article><h1 class="article-title"><a href="/2014/04/18/rspec_ctags/">Vim(TagBar)でRSpecのctagsを扱う</a></h1><div class="article-time"><time dateMime="2014-04-18 09:20:00 UTC" pubdate="pubdate">April 18 2014</time></div><div class="article-body"><p><img src="/images/2014-04-18-vim-rspec-ctags.png" alt="rspec ctags" /></p>

<p>unite-outlineとかを使う人には不要なのかもしれないけど、あいにくuniteユーザではないのでctagsでなんとかできないか調べてみた。</p>

<p>まず、Funtooで入るctagsではrspecのタグは生成できないのでforkされたctagsを使う必要がある。</p>

<p><a href="https://github.com/fishman/ctags">fishman/ctags</a></p>

<p>インストール場所はお好みで。個人的には手で入れる系のものは$HOME/localにインストールするのが好きなのでそこにインストールした。あとはTagBarの方でこのctagsを使うよう設定する。</p>
<pre class="highlight viml"><code><span class="k">let</span> <span class="nv">g:tagbar_ctags_bin</span><span class="p">=</span><span class="s2">"/home/ukstudio/local/bin/ctags"</span>
<span class="k">let</span> <span class="nv">g:tagbar_type_ruby</span> <span class="p">=</span> <span class="p">{</span>
<span class="se">    \</span> <span class="s1">'kinds'</span> <span class="p">:</span> <span class="p">[</span>
<span class="se">        \</span> <span class="s1">'m:modules'</span><span class="p">,</span>
<span class="se">        \</span> <span class="s1">'c:classes'</span><span class="p">,</span>
<span class="se">        \</span> <span class="s1">'d:describes'</span><span class="p">,</span>
<span class="se">        \</span> <span class="s1">'C:contexts'</span><span class="p">,</span>
<span class="se">        \</span> <span class="s1">'f:methods'</span><span class="p">,</span>
<span class="se">        \</span> <span class="s1">'F:singleton methods'</span>
<span class="se">    \</span> <span class="p">]</span>
<span class="se">\</span> <span class="p">}</span>
</code></pre>

<p>これで上の画像のような感じでTagBarに表示されるようになるはず。</p>
</div></article><article><h1 class="article-title"><a href="/2014/03/27/erutaso_ebuild/">lsと間違えてerutasoを打ってしまうGentoo/Funtooユーザーのみなさまへ</a></h1><div class="article-time"><time dateMime="2014-03-27 05:09:00 UTC" pubdate="pubdate">March 27 2014</time></div><div class="article-body"><p><a href="https://github.com/ukstudio/ukstudio-overlay/tree/master/app-shells/erutaso/">ebuild</a>を作ってみましたのでご活用ください。初めてのebuildなので不具合・不都合あればpull-reqを。ukstudioというoverlayを作りましたのでそこからインストールできるはずです。</p>

<p><a href="https://github.com/ukstudio/ukstudio-overlay">https://github.com/ukstudio/ukstudio-overlay</a></p>
<pre class="highlight shell"><code>curl https://raw.github.com/ukstudio/ukstudio-overlay/master/profiles/layman.xml &gt; /etc/layman/overlays/ukstudio-overlay.xml
layman -f -a ukstudio

emerge erutaso
which erutaso <span class="c">#=&gt; /usr/bin/erutaso</span>

erutaso
</code></pre>

<h2>See also</h2>

<p><a href="https://twitter.com/sgymtic/status/448832543039574016">https://twitter.com/sgymtic/status/448832543039574016</a></p>
</div></article><article><h1 class="article-title"><a href="/2014/03/18/bitlbee_hipchat/">BitlBeeでHipChatに接続する</a></h1><div class="article-time"><time dateMime="2014-03-18 05:33:00 UTC" pubdate="pubdate">March 18 2014</time></div><div class="article-body"><p>HipChatのLinuxクライアントは残念ながら日本語入力ができないのでかわりにIRCを使ってみる。
HipChatはJabberが使えるのでBitlBeeを使ってJabber経由でIRCと繋ぐことにする。BitlBee自体の設定はなにもいらないので各環境にあわせて適当に入れて起動する。</p>
<pre class="highlight plaintext"><code>sudo emerge bitlbee
sudo /etc/init.d/bitlbee start
</code></pre>

<p>次にIRCクライアントでBitlBeeに接続する。BitlBeeはlocalhostに6667ポートで立ち上がっているので(コンフィグで修正していなければ)、そこに接続する。文字コードはUTF-8でOK。
接続できたらbitlbeeの部屋でコマンドを入力し、アカウントを追加する。HipChatのJabberのアカウントは「Account Setting &gt; XMPP/Jabber info」にある。</p>
<pre class="highlight plaintext"><code>account add jabber username@chat.hipchat.com 'password'
</code></pre>

<p>次に各ユーザがニックネームで表示されるように設定する。これをやらないと数字の羅列で誰が誰だかわからない状態になってしまう。</p>
<pre class="highlight plaintext"><code>account hipchat set nick_source full_name
</code></pre>

<p>次にアカウントを有効化する。この時点で認証などもしているので失敗したらアカウント情報を見直すこと。</p>
<pre class="highlight plaintext"><code>account hipchat on
</code></pre>

<p>有効化できたらすでに部屋に参加できるが数字の羅列が頭についているので使いにくい。別の名前を割り当てることができるので適当に自分が使いやすい名前をつける。</p>
<pre class="highlight plaintext"><code>chat add hipchat room_jaber_name@conf.hipchat.com #channelname
</code></pre>

<p>ニックの設定次第だとHipChatから怒られるのでその場合HipCHatで使っている名前を設定する。</p>
<pre class="highlight plaintext"><code>channel #channelname set nick 'room nickname'
</code></pre>

<p>無事、部屋にjoinしてログが流れてきたら終了。</p>
<pre class="highlight plaintext"><code>/join #channelname
</code></pre>
</div></article><article><h1 class="article-title"><a href="/2014/03/13/bittorrentsync_qnap_funtoo/">BitTorrent SyncでQNAPとFuntooで同期する</a></h1><div class="article-time"><time dateMime="2014-03-13 03:23:00 UTC" pubdate="pubdate">March 13 2014</time></div><div class="article-body"><p>QNAPの一部のディレクトリ(主に電子書籍)とローカルのマシンで同期を取りたかったのでBitTorrent Syncで同期を取ってみる。NFSでもいいんだけど、電子書籍ぐらいならローカルにおけるぐらいのストレージ容量はあるので。</p>

<h2>QNAPにBitTorrent Syncを入れる</h2>

<p>基本的には<a href="http://www.qnap.com/useng/index.php?sn=9137">QNAPのドキュメント</a>を参照すれば問題ないと思う。簡単に説明しておくとQTSにBitTorrent Syncを追加し、BitTorrent SyncのWebUIを起動する。WebUIのアクセスユーザは途中で&quot;Please modify the Login ID / Password&quot;とか言われる画面でLogin IDとPasswordを入力し、Apply Changesをすればそのユーザで接続できる。</p>

<p>次にBitTorrent SyncのWebUIが起動したらAdd Folderから該当のディレクトリを選択する。Secret KeyはここでGenerateしておく。(後でローカルの方の設定で使用する)。QNAP側はこれで終わり。</p>

<h2>FuntooにBitTorrent Syncを入れる</h2>

<p>FuntooはportageにBitTorrent Syncのebuildがあるのでそれを使う。</p>
<pre class="highlight plaintext"><code>sudo emerge bittorrent sync
</code></pre>

<p>起動は<code>/etc/init.d/btsync start</code>だが、コンフィグの修正が必要。init.dで起動するとログがでないからわからないが、<code>/opt/btsync/btsync</code>で起動するとstorage_pathが存在しないと怒られるのがわかる。コンフィグは<code>/etc/btsync/config</code>がそう。</p>
<pre class="highlight plaintext"><code>// "storage_path" : "/home/user/.sync",
"storage_path" : "/home/ukstudio/.sync",
</code></pre>

<p>ディレクトリはお好みで。</p>

<p><code>/etc/init.d/btsync start</code>で無事btsyncが起動したら、<a href="http://localhost:8888/gui%E3%81%A7WebUI%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%A7%E3%81%8D%E3%82%8B%E3%80%82ID%E3%81%A8%E3%83%91%E3%82%B9%E3%81%AF&#x27;admin&#x27;%E3%81%A8&#x27;password&#x27;%E3%80%82">http://localhost:8888/guiでWebUIにアクセスできる。IDとパスは&#39;admin&#39;と&#39;password&#39;。</a></p>

<p>WebUIにアクセスできたら、Add FolderでQNAPと同期させたいディレクトリを指定する。Secret Keyはここでは生成させず先程のQNAPのsecret keyをコピペする。保存し、WebUIのトップ画面で&quot;connected devices and status&quot;でダウンロード速度が表示されたら無事同期がはじまっている。</p>
</div></article><article><h1 class="article-title"><a href="/2014/03/13/openvpn_qnap_funtoo/">FuntooからQNAPにOpenVPNでつなぐ</a></h1><div class="article-time"><time dateMime="2014-03-13 03:15:00 UTC" pubdate="pubdate">March 13 2014</time></div><div class="article-body"><p>まずはFuntooにOpenVPNを入れる。</p>
<pre class="highlight plaintext"><code>sudo emerge openvpn
</code></pre>

<p>次にQNAPからOpenVPNの設定ファイルをダウンロードする。場所は「コントロール・パネル -&gt; アプリケーション -&gt; VPNサービス -&gt; 設定ファイルのダウンロード」にある。(QTS 4.0.3)</p>

<p>zipが落ちてくるのでunzipするとca.crtとopenvpn.ovpnが展開されるので/etc/openvpnにmvする。他にOpenVPNで接続するところはないのでそのまま放りこむ。openvpn.opvnのままだと/etc/init.d/openvpn start時に怒られるのでopenvpn.confにリネーム。</p>
<pre class="highlight plaintext"><code>/etc/init.d/openvpn start
</code></pre>

<p>で起動する。ユーザとパスを聞かれるのでadminで認証する。他のユーザーで認証したい場合はVPNサービスの設定からユーザを追加する。ローカルIPでQNAPに繋れば無事終了。</p>
</div></article><article><h1 class="article-title"><a href="/2014/03/05/kensington_slimblade/">Kensingtonのslimbladeを導入</a></h1><div class="article-time"><time dateMime="2014-03-05 05:23:00 UTC" pubdate="pubdate">March 05 2014</time></div><div class="article-body"><p>ちょっと新しいマウスを捜してたのでこの機会にトラックボールに移行してみた。購入したのはKensingtonの<a href="http://www.amazon.co.jp/gp/product/B0024AFD42?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B0024AFD42&amp;linkCode=shr&amp;tag=ukstudio0c-22">SlimBlade</a>。</p><p>昔はLinuxで使うと上の2つのボタンが使えなかったみたいだけど、今はパッチがあたったようで問題なく使える。なぜか右奥がバックボタンなのに左奥がミドルボタンだけど。この辺のリマップはxorg.confあたりでいいのかな。あまり困りはしないのでとりあえずは特に設定を変えずに使ってみることにする。</p></div></article><article><h1 class="article-title"><a href="/2013/12/27/funtoo/">GentooからFuntooに移行しました</a></h1><div class="article-time"><time dateMime="2013-12-27 03:57:00 UTC" pubdate="pubdate">December 27 2013</time></div><div class="article-body"><p>GentooからFuntooに移行した。<a href="http://esminc.doorkeeper.jp/events/3547">Funtoo Linux インストール講習会</a>から大分日が立ってしまった。</p><p>インストール自体は<a href="http://www.funtoo.org/Funtoo_Linux_Installation">Funtoo Linux Installation</a>をそのまま実行。boot-updateのビルドだけ失敗したが、texinfo-5.1以上をmaskしたら解決。</p><p>ネット関係はNetworkManagerが妙に不安定だったのでwicdを使うことにした。wicd-cursesがいい感じ。今のところ接続も安定している。</p><p>X環境まわりは例のごとくXmonadで。GNOMEも一度入れたけど、結局使わないのでアンインストール。mix-inのGNOMEも余計なUSEフラグをつけて邪魔だったので使わないことにした。</p><p>GNOMEを削除したのでGDMではなくSlimeを使うことにした。GDMとかstartxがxinitrcを読むのかxprofileを読むのかとかいっつも忘れる…</p><p>その他GitやらRubyやら入れてひととおり終了。カーネルをバイナリで入れてるので起動が遅いけどカーネルのコンフィグでハマるのもダルいしとりあえずこのままで行く予定。</p></div></article><article><h1 class="article-title"><a href="/2013/10/18/middleman/">ブログをWordPressからmiddlemanに移行しました</a></h1><div class="article-time"><time dateMime="2013-10-18 13:53:00 UTC" pubdate="pubdate">October 18 2013</time></div><div class="article-body"><p>今まで当ブログはWordPressでブログを書いていたけれど、今回<a href="http://middlemanapp.com/">middleman</a>を使うことにした。特になにかが気に入ってmiddlemanを選んだわけでもないのだけど、しばらくはこれで運用してみようと思う。</p><p>運用はGithub Pageで行なうことにした。これで今まで中途半端に保持していたVPSを解約することができる。最近はIRCを全然使ってないからいいけど、なんかの機会に使うようになったらtiarraとかをどう運用するか考えなくちゃいけないなぁ。</p><p>デザインやその他足りない機能は追々増やしていこうとおもいます。とりあえずRSSだけは用意した。</p></div></article><div class="pager"><ul><li class="next"><a href="/page/2/">Next</a></li></ul></div></div></body></html>