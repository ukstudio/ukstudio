<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><!--Use title if it's in the page YAML frontmatter--><title>ukstudio.jp</title><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/highlight.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all.js" type="text/javascript"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="page page_19 page_19_index"><div class="cointainer-fluid"><div class="navbar navbar-default" role="navigation"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="/">UKSTUDIO</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a href="http://twitter.com/ukstudio">Twitter</a></li><li><a href="http://github.com/ukstudio">GitHub</a></li></ul></div></div></div></div><div class="container"><article><h1><a href="/2009/08/11/oauth/">2009-08-11 OAuthを使ってみた雑感</a></h1><hr /><div class="article-body">最近、TwitterのDMスパムなどで話題のOAuthですが、仕事で使ってみて色々思うところもあるのでまとめておく。

<h2>OAuthは安全か</h2>
まず、 OAuthでよく言われてるようにみえるパスワードをサービスに渡さないから安全ということに関して。簡単に言うと、「パスワード渡すよりは安全だけどまぁ信用していいかどうかの判断は必要だよね」ってところ。

OAuthは難しい話を抜きにしてしまえば、期限つきパスワード(Twitterは無期限っぽいですが)をサービスごとに発行するようなものだと思う。パスワードを渡した場合と違って、パスワードを書き換えられてログインできなくなるということはないが、APIで実行できることは基本的に出来るのでOAuthにもそれなりのリスクはある。

リスクと言ってもパスワードを第三者に渡すよりははるかに安全。先程述べたようにパスワードを書き換えられる心配もないし、仮に第三者のサービスからトークンが流出したとしても、トークンは無効化できるし、同一のパスワードを使っているサービスへの影響もない。(他のサービスと同じパスワードを使うのはどうなの?云々は置いておいて)

<h2>セキュリティより利便性</h2>
上記で述べたようにセキュリティ的にはパスワードを渡すより安全だが、ユーザ視点からみた場合のOAuthの利点はセキュリティ云々より利便性なんだと思う。

まず、パスワードの入力の手間が省ける。実際にIDとパスワードを入力してみればわかると思うけど、クリックで認証が済んでしまうOAuthの方が大分ラク。この辺は実装の詳細は違えど、利便性という意味では携帯の簡単ログインに近い。

また、パスワードを第三者のサービスに渡さないことでTwitterのパスワードを変更をする場合、Twitterのパスワードを変更するだけで済む。Twitterのパスワードを変える人がどれだけいるのか知らないけど。

<h2>サービス提供側としてOAuthを使うべきか</h2>
実際のところ、OAuthを使ったところでやることはあまりかわらない。当然、OAuthで取得したトークンが外部に漏れてしまえば、そのトークンを使用してTwitterへの発言やFollowingのremoveなどができてしまう。よってトークンが外に漏れないよう管理する必要がある。まぁそもそもデータが外部に漏れるということ自体があってはいけないことだけど。

だけどパスワードを預かるよりはユーザにとっても自分達にとっても安全なのは間違いないし、自分達の責任が限定されるという点からもOAuthを使うべき。その方がリスクが少ない。

例えば、他の同一パスワードを使用しているサービスで不正があった場合に、OAuthであればパスワードを持っていないので自分達のデータからパスワードが漏れるということがないし、そういう疑いをかけられることもない。

OAuthを使う際、サービス内部にOAuthを使用してなにをするのかを明記しておくといい。OAuthの仕組みなどを説明する必要はないが、自分達がTwitterに対してなにをするのかぐらいは書いておく方がユーザも安心できる。

現状、TwitterのOAuthの認可のページがかなり不親切かつほとんど英語なので、そのあたりは自分達でうまくサポートするしかない。

<h2>まとめ</h2>
パスワード使うよりはユーザにとってもサービスを提供する側にとってもメリットがあるのでOAuthが使えるなら使っておきましょう。
</div></article><article><h1><a href="/2009/07/27/server_maintenance/">2009-07-27 サーバのメンテナンスしてました</a></h1><hr /><div class="article-body">事後報告になってしまいますが、先週の金曜から今日にかけてサーバのメンテナンスしてました。サイトが見れなくて困った人がいたら申し訳ないです。

メンテナンスと言うか、設定を一からやりなおしたかったのと、CentOSに飽きたのでたまには違うディストリビューションにしたかったので、Gentooでビルドしなおしてました。

ブログのテーマとかも追々直していきますが、とりあえず見れるところまで。
</div></article><article><h1><a href="/2009/07/16/android_alternative/">2009-07-16 HT-03AのGmailアプリからメールを送るとmultipart/alternativeになる</a></h1><hr /><div class="article-body">先日もエントリを書いたように、今現在HT-03Aを使っているのですが、ひとつ問題が。

まぁタイトルのまんまなのですが、標準のGmailアプリからメールを送るとヘッダがmultipart/alternativeになってしまいます。もちろんWebからだとtext/plainで送れます。multipart/alternativeについては詳しくは書きませんが、多分大抵の場合、HTMLメールとして受け取ることになると思います。

<img src="http://img.skitch.com/20090716-e9kguk8wruw5t8p4a45qcruark.jpg" alt="alternative"/>

それの何が問題かと言うと、携帯に送った場合それがデコメとして認識されて受け取った側が返信する際にデコメ作成画面になってしまうということです。

要はメールを受けとる > 返信ボタンを押す > デコメ作成画面になる > 一々テキストメールに変更しなければならないといった感じに手間が増えてしまうのです。

全部の携帯がそうかはわかりませんが、auのある携帯ではそういう動作になるようです(型番は忘れた)

とりあえず、仕方がないので今のところは、Gmailアプリで受信(通知がくる) > メーラー(標準でついてくるGmail以外のメールを受信するやつ)でGmailを再度受信 > そっちで返信 とやるとなんとかtext/plainで送れます。非常に面倒です。他になにかいい方法があれば教えてください。

ちなみに、この件でDoCoMoのサポセンに問合せたところ、「標準のGmailアプリではテキストメールしか送れません。細かいことはGmailのヘルプを参照してください。」と言われてしまいどうしたもんかなーといったところです。

もし、誰か標準のGmailアプリでtext/plainでメールを送る方法をご存知でしたら教えてもらえるとありがたいです。
</div></article><article><h1><a href="/2009/07/16/ht_03a_gtalk/">2009-07-16 HT-03AでGtalkまわりでハマッったのでメモ</a></h1><hr /><div class="article-body">なんだか変なところではまるな、android。

Gtalkでチャットをする時は大体クライアント側でその人を登録すると思うんですが、連絡帳にすでにその人が登録してあった場合、マージ的なことはしてくれません。具体的な例で説明した方がわかりやすいと思うので具体例しめします。

<ol>
<li>連絡帳にすでにAさんが登録してあり、携帯アドレスとGmailアドレスが登録されています</li>
<li>その人とGtalkで会話したいのですが、連絡帳に登録してあっても一度フレンド登録しないといけなません</li>
<li>なのでフレンド登録する</li>
<li>無事会話できるが、連絡帳にAさんが2人存在してしまう(手動で登録したものと、Gtalkでフレンド登録したもの)</li>
<li>Gmailの連絡帳で、アカウントの統合ができるので統合する</li>
<li>Gtalkで会話できなくなる</li>
</ol>

で、じゃあ2つ登録されてしまったアカウントはどうしたらいいのかと言うと、<strong>Gtalkでフレンド登録された時に作られたアカウントの方に、最初から登録されていた方のデータをうつしてください。</strong>

ちなみに僕は一度Gtalkのフレンドリストが全部消えたのですが、多分連絡帳整理の際に一度連絡先を全て消したためだと思います。Gtalkのフレンドリストが消えないようにするには、上記のようにフレンド登録されたアカウントはそのまま残しておかないとダメなんだと思います。

ちなみに、僕が知ってる範囲ですが、フレンド登録されているアカウントかどうかの区別はチャットができるかできないかでしか判断できないと思います。具体的に言うと連絡帳をWebで見たときに「チャット」のリンクがあるかどうかぐらいだと思います。
</div></article><article><h1><a href="/2009/07/14/rails_oauth_twitter/">2009-07-14 RailsからOAuthを利用してTwitterにポストする</a></h1><hr /><div class="article-body">OAuthの細かい説明は抜き。

まず、OAuthを使うためにはTwitterでアプリケーションの登録が必要なので、<a href="http://twitter.com/oauth_clients">http://twitter.com/oauth_clients</a>で登録をしておいてください。 以下のコードの6行目の部分を取得したConsumer keyとConsumer secretをに置き換えてください。

<script src="http://gist.github.com/146684.js"></script>

適当なところからverifyアクションにリダイレクトしてくると、さらにTwitterにリダイレクトします。その後、callbackアクションに戻ってくるので、そこで認証して取得したトークンをUserモデルに保存します。(ここでは自分のサービスにログインしているユーザが認証を行っています。)

その後、保存したトークンを使ってTwitterに発言をします。リクエストが受け入れられなかった場合の処理などは省いてます。

<script src="http://gist.github.com/146685.js"></script>

Twitterには取得したトークンに有効期限はありませんが、有効期限が存在するものもある(どちらかというとそっちの方が多いのかも)気をつける必要があります。

ちなみに細かいことを調べていないので「トークンをDBに保存してしまっていいのか」とか「トークンが外部に漏れてしまった場合はどうしたらいいのか」などについてはよくわかっていません。
</div></article><div class="pager"><ul><li class="previous"><a href="/page/18/">Prev</a></li><li class="next"><a href="/page/20/">Next</a></li></ul></div></div></body></html>