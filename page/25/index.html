<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><!--Use title if it's in the page YAML frontmatter--><title>ukstudio.jp</title><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/highlight.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all.js" type="text/javascript"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="page page_25 page_25_index"><div class="cointainer-fluid"><div class="navbar navbar-default" role="navigation"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="/">UKSTUDIO</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a href="http://twitter.com/ukstudio">Twitter</a></li><li><a href="http://github.com/ukstudio">GitHub</a></li></ul></div></div></div></div><div class="container"><article><h1><a href="/2008/10/28/todo/">2008-10-28 RTMとか挫折するので自分に合うTODO管理を考えてみた</a></h1><hr /><div class="article-body">RTMとか今までに数回使おうとして、なぜかいつも使わなくなる。RTM自体は使いやすいんだけど、多分ブラウザベースが合わないんだろう。CUIでタスク管理したい!って思って以前試したけど(名前わすれちゃった)、なんかそれも合わなかった。

んで、今回自分なりに考えたToDo管理は下のような感じ。ちなみにオレの使ってるOSはMacな。Linuxでも大丈夫だと思うけど。windowsはしらん。

<ul>
<li>ToDoの作成は「touch todo名.txt」</li>
<li>ToDoの詳細はそのファイルに書き込めばいい</li>
<li>終わったToDoは「rm todo名.txt」</li>
<li>プロジェクトや階層分けしたかったら「mkdir project名」</li>
<li>オンライン管理はdropboxかgitとか</li>
</ul>

正直、ToDo作るときはブラウザでBTSみながらとか作るので、ブラウザでToDOを作るのは相性が悪い。それに対してMacのTerminalはブラウザとセットで開いてることが多い(webプログラマだからね)、ブラウザで見ながらToDoを作るのは非常にラク。

なにより、touch、rm、mkdir、mvといったコマンドは普段から日常的に使っているのですぐ馴染みそう。あと、この方式の利点はunix系のコマンドが使えることかな。grepとかfindとかsortとか。

オンライン管理はとりあえず必要性を感じてないけれど、最近流行りのdropboxとかgitとかでいいかなと思ってる。変更履歴とか差分とか見たかったらgitだけどそこまでする必要も感じてないし、dropboxでいいのかな。iPhone対応してるらしいし。iPhoneもってないけどさ。

そんな感じでしばらく試してみることにする。
</div></article><article><h1><a href="/2008/10/27/xss/">2008-10-27 XSS対策に入力時エスケープは非常にややこしい</a></h1><hr /><div class="article-body">to-Rさんの<a href="http://blog.webcreativepark.net/2008/10/24-201629.html">XSSの脆弱性を限りなくなくす方法</a>を読んでなんかもにょもにょしたのでエントリーを書く。多分、to-Rさんはこれから書くことに関して理解してて、あの対策を行なってるのかもしれないけど、それでも書く。自分の勉強も兼てるので変なところがあれば教えていただけるとありがたいです。

入力時エスケープは非常に<strong>ややこしい</strong>

確かに、入力値に必ずエスケープしておけば、XSS対策漏れにはなるかもしれない。けれど非常にややこしいことになる。

例えば、受け取ったデータの文字列に対して文字数制限のバリデーションを行なうときにわざわざアンエスケープの処理を行なわないといけないし、DBへの保存の際にもアンエスケープが必要になる。ブログとかでフォームから受け取ったデータのうち、一部のタグは許容するときとかもかな。

<blockquote>
ベストの対策はアプリの性質に合わせたエスケープなんだけども、これって完全になくすにはかなりの几帳面さが必要になるんじゃないかなと思います。(規模が大きくなればなるほど)
</blockquote>

とエントリーでは書かれているけど、この対策が大規模になればなるほどXSSに限らず色々な問題が発生する気がする。大規模であればあるほど、出力箇所をみて「対策されている」というのがわかるのが大事。

コードを書きながら「DBに保存するからアンエスケープ・・・」「スクリプトとして出力するからアンエスケープ」って考えるよりは、「HTMLの出力時にエスケープ」の方がわかりやすいはず。出力時をみればいいんだから。

ちなみにフレームワークやテンプレートエンジンが出力時のエスケープをデフォルトで行なうってのは賛成です。なぜなら使っているフレームワークまたはテンプレートエンジンがエスケープしているということが自明なら、エスケープの有無を確認する必要がなくなるから。PHPとかWeb特化とか言うぐらいなら、デフォルトでエスケープして出力すればいいのにと思う。

なんかXSS対策とかエスケープって言い方がよくない気もするな。普通に「スクリプトを無効にする」とかで良い気がしてきた。スクリプトが有効になるのは、HTML出力時なんだからその時に無効化すればいいよね。

というか、PHPの人はmagick quoteでこりたと思ってたんだけど。

<h2>追記</h2>
ブクマコメ、高木さんより。
<blockquote>
「普通に「スクリプトを無効にする」とかで良い気がしてきた」&lt; XSSはスクリプトだけじゃない。&gt;iframe&lt;の挿入&lt;form&gt;の挿入を考えてみるよろし。CERT CA-2000-02ではXSSと呼ばず「Malicious HTML Tags Embedded in Client Web Requests」と呼んだ
</blockquote>

あー、確かにそうですね。指摘ありがとうございます。Malicious HTML Tags Embedded in Client Web Requestsは初耳でした。
</div></article><article><h1><a href="/2008/10/06/vimm3/">2008-10-06 VimM#3開催のお知らせ</a></h1><hr /><div class="article-body">11月の22日(土)の14時からVimM#3を開催します。

今回のテーマは「脱初心者」ということでなるべくなら初心者の方に来てもらいたいなと思っています。なんかメンバーみると結構「おまえ初心者じゃないだろう!」て人がいるので、負けずに初心者の方もいっぱい来てください。

スピーカーもまだ募集しているので応募お待ちしております。

今回の会場もささださんとほしさんにご協力頂きました。二回連続にわたりありがとうございます。

<a href="http://wiki.livedoor.jp/biowithit/d/VimM%233">VimM#3</a>
</div></article><article><h1><a href="/2008/10/04/rails_many_db/">2008-10-04 RailsでMySQLとPostgreSQLを同時に扱う方法(+問題点)</a></h1><hr /><div class="article-body">プラグインとか無しで、複数のDB(MySQLとPostgreSQL)を扱う方法。Rails2.1でしか試してないけど、多分1.2とかでも大丈夫。多分。MySQLとPostgreSQLの接続ライブラリはgemからインストールしておくこと。

まずは、database.ymlに扱うデータベースの定義を書く。

<pre lang="ruby">
development:
  adapter: mysql
  encoding: utf8
  database: db_development
  username: root
  password:

test:
(面倒だから略)

production:
(面倒だから略)

psql_development:
  adapter: postgres
  encoding: utf8
  database: ma2_mcd
  username: root
  password:

psql_test:
(面倒だから略)

psql_production:
(面倒だから略)

</pre>

次にPostgreSQLに接続させたいモデルを編集する。例えば、ProfileモデルはPostgreSQLの方に接続させたい場合は以下のようになる。

<pre lang="ruby">
class Profile < ActiveRecord::Base
  establish_connection("psql_#{RAILS_ENV}".to_sym)
end
</pre>

establish_connectionにシンボルでdatabase.ymlの定義を渡せば、そのモデルはその定義のデータベースに接続する。本番、テスト、開発でそれぞれ定義が違うだろうから、RAILS_ENVで今起動している環境の定義を呼び出すようにしてやる。

<h2>追記</h2>
上記の設定で一応アプリは動作するけど、いくつか問題点があるのでそれをメモしておく。

<h3>マイグレーションの使い分けはどうする</h3>
例えば、db/migrateにcreate_hoge_for_psql.rb(数値は略)とcreate_foo_for_mysql.rbと合った場合、それをどう実行するかが問題になってくる。

普通にrake db:migrateやrake db:migrate RAILS_ENV=psql_developmentとやったら、hogeとfooが両方とも作られてしまう。こちらとして望んでるのは、hogeがPostgreSQLのみ、fooがMySQLのみにできて欲しい。

うーむ、弱った。
</div></article><article><h1><a href="/2008/09/19/no_use_number_prime/">2008-09-19 数字を使わずに素数判定</a></h1><hr /><div class="article-body">86のSkypeチャットで話題になったのでちょこちょこっと書いた。普通にループして比較するだけお。もっといい方法あるんだろうけど、とりあえずはよしとする。

<pre lang="ruby">
class Integer
  def prime?
    return false if self.zero? || self == [[]].size
    ([[],[]].size...self).each do |i|
      return false if (self%i).zero?
    end
    true
  end
end
</pre>

suztomoのやつ。
<a href="http://d.hatena.ne.jp/suztomo/20080918/1221746629">http://d.hatena.ne.jp/suztomo/20080918/1221746629</a>
</div></article><div class="pager"><ul><li class="previous"><a href="/page/24/">Prev</a></li><li class="next"><a href="/page/26/">Next</a></li></ul></div></div></body></html>