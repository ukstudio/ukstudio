<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><!--Use title if it's in the page YAML frontmatter--><title>The Middleman</title><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/highlight.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all.js" type="text/javascript"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="2007 2007_index"><div class="header"><div class="header-navigation"><ul><li><i class="fa fa-twitter"></i><a href="http://twitter.com/ukstudio">Twitter</a></li><li><i class="fa fa-github-alt"></i><a href="http://github.com/ukstudio">GitHub</a></li></ul></div><div class="header-title"><a href="/">UKSTUDIO</a></div></div><div class="container"><h1><Archive></Archive>2007</h1><article><h2><a href="/2007/12/30/rubycocoa_brainfuckinterpreter/">2007-12-30 RubyCocoaでBrainFuckインタプリタっぽいものを作ってみた</a></h2>初めてのRubyCocoaでのプログラミング。以前作ったBrainfuckのコードを処理するRubyプログラムを流用した。主に参考にしたのは<a href="http://limechat.net/rubycocoa/tutorial/">RubyCocoa 入門</a>。と言うか、ここしか見てない。

<img src="http://farm3.static.flickr.com/2055/2148748886_48f93983a6.jpg?v=0"/>

上のテキストフィールドにBrainfuckのコードを入力して、executeのボタンを押すと変換された文字列が下のフィールドに表示される。キャプチャのBrainfuckのコードは途切れてるだけで、実際はもっと長い。本当はテキストエリアみたいなのにしたかったんだけれど、オブジェクトがどれだかわからなかった。

以前、Objective-Cで少しだけCocoaプログラミングをした時も同じことを思ったけど、Interface BuilderはやっぱりUIを設計していく上で優秀だと思う。コントローラクラスとオブジェクトを関連づける操作もかなり直感的でさすがAppleと言ったところか。
</article><hr /><article><h2><a href="/2007/12/28/mac_leopard/">2007-12-28 Leopardをインストール</a></h2>来年から仕事でMacBookを使う可能性がでてきたのもあって、OSをLeopardに入れ替えた。仕事で使い始めると入れ替えるタイミングが難しくなるからね。

<h2>Webクリップウィジェット</h2>
LeopardからSafariで見ているページをDashboardにクリップできるようになった。試しに<a href="http://suztomo.net/fuwatter/">Fuwatter</a>をクリップしてみた。特に重たい感じもなく、普通に動く。
<img src="http://farm3.static.flickr.com/2120/2142228842_35d88c1b29.jpg?v=0" alt="fuwatter"/>

<h2>Time Machine</h2>
まだ未使用。使ってない外部HDDがあるからそのうち試そうと思う。

<h2>デスクトップ</h2>
とりあえずStack機能とやらを試してみた。表示の種類に「ファン」と「グリッド」とあるが、個人的にはグリッドの方が好き(キャプチャの方) ただ、ディレクトリにはTerminalからか、QuickSilverからアクセスすることがほとんどなので、有効活用するかどうかはまだちょっとわからない。
<img src="http://farm3.static.flickr.com/2078/2142243412_77b80fabd7.jpg?v=0"/>

あと、細かいことだけど画像ファイルのアイコンが、その画像を縮小したものになっているのが地味にうれしい。画像はファイル名が無意味なものが多いオレとしては探しやすくて非常に良い。

<h2>Spaces</h2>
今回の新機能で実はコレが一番うれしいかもしれない。とりあえず4つに分割してるけど、Spacesの切り替えが頭の切り替えと直結してる感じで若干集中力が増した様な気がする。気がするだけかもしれない。

<img src="http://farm3.static.flickr.com/2403/2142274130_1e23c0dab0.jpg?v=0"/>

<h2>インストールしたもの</h2>
今回インストールしたアプリ。メモがてら。
<h3>開発系</h3>
<ul>
<li>Xcode</li>
<li>Dashcode</li>
<li>MacPorts</li>
<li>zsh-4.3.4(MacPortsで)</li>
<li>Ruby、Perl(MacPortsで)</li>
<li>vim(MacPortsで)</li>
<h3>コミュニケーション系</h3>
<li>Adium</li>
<li>Skype</li>
<li>LimeChat for Mac OS</li>
<h3>ユーティリティ</h3>
<li>QuickSilver</li>
<li>Chemr</li></ul>
</article><hr /><article><h2><a href="/2007/12/26/ikebukuro_faultier/">2007-12-26 仕事帰りの池袋にて</a></h2>仕事帰りに池袋のジュンク堂に寄ってアジャイルプラクティスとRESTfulWebサービスを購入。アジャイルの方の在庫が心配だったけど、なんとか2冊残ってた。薄いし、通勤途中で読もうと思う。やっぱ表紙がかっこいい。

<table class="g-tools_table"><tr><td colspan="2"><span class="g-tools_title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4274066940/ukstudio0c-22/" target="_top">アジャイルプラクティス 達人プログラマに学ぶ現場開発者の習慣</a></span></td></tr><tr><td valign="top"><span class="g-tools_img"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4274066940/ukstudio0c-22/" target="_top"><img src="http://ecx.images-amazon.com/images/I/31paqWCAEVL.jpg"  alt="アジャイルプラクティス 達人プログラマに学ぶ現場開発者の習慣" /></a></span></td><td valign="top"><span class="g-tools_body">Venkat Subramaniam Andy Hunt 木下 史彦 <br /><br /><br /><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4274066940/ukstudio0c-22/" target="_top">Amazonで詳しく見る</a></span><span class="g-tools_by"> by <a href="http://www.goodpic.com/mt/aws/index.html" >G-Tools</a></span></td></tr></table>

<table class="g-tools_table"><tr><td colspan="2"><span class="g-tools_title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873113539/ukstudio0c-22/" target="_top">RESTful Webサービス</a></span></td></tr><tr><td valign="top"><span class="g-tools_img"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873113539/ukstudio0c-22/" target="_top"><img src="http://ecx.images-amazon.com/images/I/21RXsMNvdwL.jpg"  alt="RESTful Webサービス" /></a></span></td><td valign="top"><span class="g-tools_body">Leonard Richardson Sam Ruby 山本 陽平 <br /><br /><br /><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4873113539/ukstudio0c-22/" target="_top">Amazonで詳しく見る</a></span><span class="g-tools_by"> by <a href="http://www.goodpic.com/mt/aws/index.html" >G-Tools</a></span></td></tr></table>

ついったーでfollowしている<a href="http://twitter.com/faultier">faultier</a>さんもジュンク堂にいて、お互い全く面識のないうちらはついったーで同じフロアにいることを知りつつもニアミスしまくり。結局、レジで支払いしたあと外の電話ボックスで合流。

せっかくお会いできたので、一緒にご飯に行くことに。年齢が近いうえに(向こうが85'sでこっちが86's)お互いRubyが好きなので話がはずむはずむ。

他の同世代のエンジニアの名前を上げて、悔しいだのなんだの。オレらも負けてられないねーとか。RubyCocoaでなんか作ってみたいねーだの。Twitterの話だの。1時間程度だけどかなり楽しかった。

オレは高校の時、公立の情報技術科に通ってたんだけど、そこは授業でC言語プログラムをするわけ。でも、プログラムが好きな人なんてほとんどいないわけ。中学からC言語やってたオレはある程度の成績は残してたんだよね。少くともプログラムにおいては。

そうするとなんか調子にのって、「この年代じゃあ自分は"できる"方だな」とか思ってたりしたんだよね。でも、ついったー始めて、色んな人に会ったり、ブログを読むうちに自分って大したことないな、天狗になっちゃいけないなって思い始めて・・・

とか話してたら向こうも「わかる!」って言ってくれて、なんかそれがすごいうれしかった。似たような話を他の人にしたことがないわけじゃないけれど、同世代のプログラマに話したのは実は初めて。

うん、まぁ。がんばろう。

そういえば別れ際に「他の同世代のエンジニアとも話してみたいね」って2人で話してた。amacangの81'sオフじゃないけれど、10代後半や20代前半のエンジニアで集まってみるのも悪くないかも。<a href="http://uk-studio.net/2007/11/30/1986_engineer/">似たようなこと</a>を前にも言った気がするけどね。

多分、似たようなことを思ってる人はそれなりにいるはず。今のところ具体的に何かしようとか思ってるわけじゃないけど、そのうち小・中規模(20人いかないぐらい)の飲み会ぐらいは開いてみたいね。

<strong>12/26 追記</strong>
10代後半をターゲットに入れてるくせに飲み会とか意味わかんないですね。そこらへんは追い追い考えときます・・・
</article><hr /><article><h2><a href="/2007/12/26/rhg-strikes-back/">2007-12-26 「RHG片手にRuby 1.9の実装を読む集い」に参加する予定</a></h2><a href="http://qwik.jp/rhg-strikes-back/">The RHG Strikes Back - RHG片手にRuby 1.9の実装を読む集い</a>

RHG持ってないけど・・・

Twitterでyuguiさんが「<a href="http://twitter.com/yugui/statuses/531123082">1月からRHGを片手に1.9を読む会を始めます</a>」と言っていたのでせっかくなので参加表明。

正直、他の方々のレベルについていける自信はない。最後にC言語を使ったのいつだろう・・・

まぁでも、個人的にいつか処理系を実装を読んでみたいと思ってたし、他のRubyistと交流をとるいい機会なので思い切って参加表明。なんとかなるだろう、多分。

参加者を見た限りじゃ会ったことある人の名前がちらほら。集いでお会いしたときはどうぞよろしくです。
</article><hr /><article><h2><a href="/2007/12/20/tanoshi_ruby_sec10_practice/">2007-12-20 たのしいRuby 第10章 練習問題</a></h2>たのしいRuby 第10章 数値(Numeric)クラスの練習問題をやってみた。

(1)と(2)は華氏を摂氏、もしくは逆の摂氏を華氏に変換するプログラムを書けと言う問題。小数点以下を求める為に引数をFloat()で囲む。そんなに難しい問題じゃないので、テストはかなり適当。

<pre lang="ruby">
def cels2fahr(cels)
  Float(cels) * 9 / 5 + 32
end
</pre>
<pre lang="ruby">
require 'test/unit'
require 'cels2fahr'

class TestCels2Fahr < Test::Unit::TestCase
  def test_cels2fahr
    assert_equal(50, cels2fahr(10))
    assert_equal(77, cels2fahr(25))
  end
end
</pre>
</pre><pre lang="ruby">
def fahr2cels(fahr)
  (Float(fahr) - 32) * 5 / 9
end
</pre>
<pre lang="ruby">
require 'test/unit'
require 'fahr2cels'

class TestFahr2Cels < Test::Unit::TestCase
  def test_fahr2cels
    assert_equal(10, fahr2cels(50))
    assert_equal(25, fahr2cels(77))
  end
end
</pre>

(3)は乱数の問題。1から6までの数字を出力するメソッドdiceを実装する。乱数のテストって何書いたらいいんだろう。今回はテストは用意しなかったけど、1から6までの数値かどうかのテストぐらいは用意するべきだったのかな。

</pre><pre lang="ruby">
def dice
  rand(6) + 1
end
</pre>

(4)は引数が素数かどうかを調べるメソッドの実装。2より小さい数(負数、0、1)は即falseを返す。それ以上の数は引数の平方根までの数で割り切れるか調べ、途中で割り切れたら素数ではないので、falseを返す。ループを抜けたら素数なのでtrueを返す。

<pre lang="ruby">
def prime?(num)
  return false if num < 2
  (2..Math.sqrt(num)).each do |i|
    return false if (num % i).zero?
  end

  true
end
</pre>
</pre><pre lang="ruby">
require 'test/unit'
require 'prime'

class TestPrime < Test::Unit::TestCase
  def test_prime
    assert(!prime?(0))
    assert(!prime?(1))
    assert(prime?(2))
    assert(prime?(3))
    assert(!prime?(4))
    assert(prime?(5))
    assert(prime?(13))
    assert(prime?(17))
    assert(prime?(113))
  end
end
</pre>

書いたコードはCodeReposにCommitしてみた(<a href="http://coderepos.org/share/browser/dan/ruby/tanoshi_ruby/sec10_numeric">/dan/ruby/tanoshi_ruby/sec10_numeric/</a>)。突っ込み、添削大歓迎です。これぐらいの規模のプログラムだと添削とかしづらいかもですが。

<table class="g-tools_table"><tr><td colspan="2"><span class="g-tools_title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4797336617/ukstudio0c-22/" target="_top">たのしいRuby 第2版 Rubyではじめる気軽なプログラミング</a></span></td></tr><tr><td valign="top"><span class="g-tools_img"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4797336617/ukstudio0c-22/" target="_top"><img src="http://ecx.images-amazon.com/images/I/11FDBHKSKWL.jpg"  alt="たのしいRuby 第2版 Rubyではじめる気軽なプログラミング" /></a></span></td><td valign="top"><span class="g-tools_body">高橋 征義 後藤 裕蔵 <br /><br /><strong>おすすめ平均</strong> <img src="http://g-images.amazon.com/images/G/01/detail/stars-3-5.gif" /><br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />プログラミング初心者にとっては少し難易度が高いかも<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />変数のスコープと寿命について詳しく書いて欲しかった<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />練習問題の内容にやや難あり<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />Rubyをこれから覚える方は必読かも<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-1-0.gif" alt="stars" />読みやすいだけ<br /><br /><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4797336617/ukstudio0c-22/" target="_top">Amazonで詳しく見る</a></span><span class="g-tools_by"> by <a href="http://www.goodpic.com/mt/aws/index.html" >G-Tools</a></span></td></tr></table></pre>
</article><hr /><article><h2><a href="/2007/12/20/fixdap_ruby_project/">2007-12-20 fixdap.jpに「Rubyを極める」プロジェクトを作ってみました</a></h2><a href="http://fixdap.com/p/Ruby/">Rubyを極める - fixdap</a>

@mobcovが<a href="http://fixdap.com/p/RubyCocoa/">RubyCocoaを極める - fixdap</a>を。@faultierが<a href="http://fixdap.com/p/rspec/">RSpecを極める - fixdap</a>を作っていたので、それらの姉妹プロジェクトってことで。

とりあえず、あまり難しいことは考えてないので「こんな勉強をしてみよう」とか「Rubyで○○なプログラムを書いてみよう」とかちょっとしたことでもタスク作っちゃって欲しいなと思う今日この頃。

丁度、近いうちに「たのしいRuby 第2版」の練習問題をちゃんとやろうと思ってたのでそのタスクを作ってみた。(<a href="http://fixdap.com/p/Ruby/1760/">http://fixdap.com/p/Ruby/1760/</a>)書いたプログラムはこのブログにでも貼りつけて、そのリンクをfixdapの方にコメントで書けばいいかな。

もしくは、CodeReposにCommitしちゃうってのもありかなー。/lang/ruby/study/tanoshi_ruby/とかで。んで、もし添削したい人とかいたら勝手に修正してCommitしちゃえばいいし。あまりにも書き直すようであれば、fixdapのコメントで一言言うか、気にせずCommitして、svnのコメントになんかしら書いておけばいいし。

プロジェクトメンバーがオレ１人なのが寂しいなー。作ったばかりだから仕方ないけどw

<h2>追記 07/12/20</h2>
yappoさんからブクマでコメントもらいました。
<blockquote>
yappo coderepos 添削用は coderepos.org/share/dan 以下で
</blockquote>
とのことなので、coderepos.org/share/dan/ruby/tanoshi_ruby/とか作ろうと思います。yappoさん、ありがとう。

あとプロジェクトメンバーがちょこっと増えてた。わっほい。
</article><hr /><article><h2><a href="/2007/12/05/ruby_array_operator/">2007-12-05 RubyのArrayの演算子はちょっとおもしろい</a></h2>Arrayの「+」「-」「&」「|」演算子がちょっとおもしろい。
<h2>+演算子</h2>
お互いを連結した新しい配列を返す。
<pre lang="ruby">
[1, 2, 3] + [4, 5, 6] #=> [1, 2, 3, 4, 5, 6]
</pre>

<h2>-演算子</h2>
重複した要素を取り除いた新しい配列を返す。
<pre lang="ruby">
[1, 2, 3, 4, 5] - [1, 3, 5] #=> [2, 4]
</pre>

<h2>&演算子</h2>
重複した要素からなる新しい配列を返す。
<pre lang="ruby">
[1, 2, 3, 4, 5] & [1, 3, 5] #=> [1, 3, 5]
</pre>

<h2>|演算子</h2>
どちらかに含まれている要素からなる新しい配列を返す。
<pre lang="ruby">
[1, 2, 3, 4, 5] | [1, 3, 5, 7, 9] #=> [1, 2, 3, 4, 5, 7, 9]
[1, 3, 5] | [1, 2, 3, 4, 5] #=> [1, 3, 5, 2, 4]
</pre>
</article><hr /><article><h2><a href="/2007/12/05/install_retrospectiva/">2007-12-05 RetrospectivaをMacBookに設置してみた</a></h2><a href="http://retrospectiva.org/blog">blog . retrospectiva</a>

どんなものか試しに設置してみた。あくまで試しなのでSQLite、WEBrickで。まずは必要なソフトのインストールから。

<h2>SQLite3のインストール</h2>
MacPortsを使ってSQLiteを、RubyGemsを使ってSQLiteを扱うライブラリをインストール。
<pre lang="bash">
% sudo port install sqlite3
% sudo gem install sqlite3-ruby
</pre>

<h2>retrospectivaの設置</h2>
<a href="http://retrospectiva.org/wiki/Quick+install">Quick Install - wiki . retrospectiva</a>を参考にしつつ。

<pre lang="bash">
% svn export http://retrospectiva.googlecode.com/svn/branches/1-0 retrospectiva
% cd restrospectiva
</pre>

リポジトリからファイルを持ってきたら、DBの設定がMySQLになっているのでSQLiteの設定に変更。
<pre lang="bash">
% mv config/database.yml.todo config/database.yml
% vim config/database.yml
</pre>
<strong>database.yml</strong>
<pre lang="ruby">
development:
  adapter: sqlite3
  database: retrospectiva_development

test:
  adapter: sqlite3
  database: retrospectiva_test

production:
  adapter: sqlite3
  database: retrospectiva
</pre>

rakeは試しなのでdevelopment(引数なし)で。特にエラーがでないようならWEBRickを起動してhttp://localhost:3000/にアクセス。

<pre lang="bash">
% rake db:retro:load
% ruby script/server
</pre>

IDとパスワードを聞かれるので admin / passwordを入力。

適当にプロジェクトを作ってみた感じが以下のキャプチャ。
<img src="http://farm3.static.flickr.com/2067/2086299815_6a6030a3b6.jpg?v=0"/>

SVNの連携とかはまたそのうち。Rails環境があれば、とりあえず起動するのはラクチン。
</article><hr /><article><h2><a href="/2007/12/01/ruby_rpn_ujihisa_sixeight/">2007-12-01 後置記法のコードを添削してもらっちゃいました</a></h2><a href="http://ujihisa.nowa.jp/entry/60c2b3fcf9">rubyneko - Re: UK STUDIO 後置記法での計算</a>
<a href="http://d.hatena.ne.jp/Sixeight/20071130/1196438912">後置記法での計算の添削に便乗してみた - チナミニ</a>

ujihisaさんとSixeightさんには感謝です。せっかくなんで添削してもらったコードを自分なりにちゃんと理解しときたいと思います。

<h2>ujihisaさんのコード</h2>

<pre lang="ruby">
class String
  def rpn
    expr = self.split(" ")
    stack = []
    operators = %w[+ - * /]

    expr.each do |i|
      if operators.include? i
        stack = [calc(i, stack)]
      else
        stack < < i.to_i
      end
    end

    stack[0]
  end

  private
  def calc(operator, stack)
    stack.inject {|result, i|
      result.__send__(operator, i)
    }
  end
end
</pre>
<h3>stackに文字列でなく数値を格納していく</h3>
確かに所々でto_i使い過ぎだ。これだけで全然スッキリするなぁ・・・
<h3>スコープは狭く</h3>
ですよねぇ。なんでクラス変数にしたんだろう、おれは。猛省。
<h3>Array.newを[]に</h3>
個人的にはなんかArray.newがしっくりくるんですよね。「Arrayをnewする」みたいな感じで。[]だとあまりそんな感じがしない。

まぁ慣れの問題な気もするので、[]も使っていこうと思います。

<h3>returnは省略</h3>
これはなんか個人的には解決してない問題でして。値を返すことを強調したいときはreturnをつけようとか思っていたんだけど。

ただ、Rubyは必ず値が返ってくることを考えると、やっぱり基本的に省略なのかなぁ。

ちなみにTwitterでぼそっとぼやいたらこんな反応が。
<ul>
<li><a href="http://twitter.com/yuki_neko_nyan/statuses/456843452">http://twitter.com/yuki_neko_nyan/statuses/456843452</a></li>
<li><a href="http://twitter.com/natsutan/statuses/456852982">http://twitter.com/natsutan/statuses/456852982</a></li>
</ul>

<h3>Array(...)を[...]に</h3>
[]で囲むのでもいいのか。知らなかった。

<h3>calcがArrayを返すより、stackに入れるときにArrayにするべし</h3>
説明がなんかHaskellerっぽいですな。

calc::char->[int]->[int]ってどう言う意味だっけ。確か、第1引数の型->第2引数の型->返り値の型だったかな。[int]はintの配列ってことかな・・・

確かにcalcの処理内容を考えると[int]よりintの方がわかりやすいな。ふむ。

<h3> eachのブロックを{}からdo endに</h3>
そもそも、自分のコーディング規約を守ってない件。複数行のブロックはdo...end使うって決めたのに!

<q>副作用を目的としているケースでは、こちらのが直感的</q>とあるけど、何故だかちょっとわからない。直感的ってのもまた人それぞれな部分あるしなぁ。

<h3>if i == "+" || i == "-" || i == "*" || i == "/"をArray#include?を使ってシンプルにまとめた</h3>
このifは自分でも汚いなとは思ってた。各演算子を配列にまとめてinclude?で判断か。ブロック引数iの値が配列に含まれていればtrueを返すから、この場合だと"+", "-", "*", "/"のどれかだとtrueになると。

<h3>calcについて</h3>
</pre><pre lang="ruby">
result.__send__(operator, i)
</pre>
って記述を見たとき、「あれ、resultに代入しなくていいの?」とか思ったんだけど、ちゃんと調べてみると途中のブロックの返り値は次の呼び出しの時にresultに渡されるんだとさ。ちゃんと調べろよって話ですね。


ujihisaさんにはさらに短かくしたコードも書いてもらってるんだけどまだちょっと追えてない。これはまた後日こっそり調べとく。

<h2>Sixeightさんのコード</h2>
関係ないけどSixeightさんってtyoroの後輩だっけ?

<pre lang="ruby">
class String
  # Reverse Polish Notation
  # '4 5 +'.rpn => 4 + 5 = 9
  def rpn
    stack = []
    opr = %q[ + - * / ]

    split(' ').each do |i|
      if opr.include? i
        stack[-1] = stack[-2].__send__(i, stack.pop)
      else
        stack < < i.to_i
      end
    end
    stack.first
  end
end
</pre>
一応、最終的なコードを見せてもらう。(もちろん、その前のコードも読みましたよ)全体的にSixeightさんもujihisaさんのコードを見たあとのせいか、基本的には上で書いたことと同じ感じかなー。

ただ、演算の処理をメソッドで別にせず1行で済ませてますな。あとオレの場合はめんどくさくて、stackを全部上書きしちゃってるけど、Sixeightさんはpopで取り出してちゃんと処理してる。

個人的にはstack[-1]とstack[-2]が気になるかな。インデックスの-が個人的に好きじゃないようで。まぁあんなcalcメソッド書いといて何言ってるんだって感じですよね。すみません。

逆ポーランド記法の仕様についてはあまりちゃんと調べてなかったり。なんかSchemeの前置記法と似た感覚で複数の値も計算するもんだと思ってたけど違うのかな。

<h3>追記</h3>
はてブにSixeightさんのコメントが!
<blockquote>
インデックスの-は僕も否定派なんですが、スタックから取り出す順番をひっくり返すのが思い浮かばなくて＞＜精進しなきゃ
</blockquote>
やっぱ-は否定的なのかー。お互いがんばりまっしょい。

<h2>書き直したコード</h2>
</pre><pre lang="ruby">
class String
  def rpn
    expr = self.split(" ")
    stack = []
    operators = %w[+ - * /]

    expr.each do |i|
      if operators.include? i
        stack = [stack.inject{|result, item| result.__send__(i, item)}]
      else
        stack < < i.to_i
      end
    end

    stack.first
  end
end
</pre>
ujihisaさんのコードをほとんど反映させた感じ。例外処理とか考えてないよ。あとスタックにある数値も全部計算する仕様のまま。</pre>
</article><hr /><article><h2><a href="/2007/11/29/ruby_rpn/">2007-11-29 後置記法での計算</a></h2><a href="http://ja.wikipedia.org/wiki/逆ポーランド記法">後置記法</a>の文字列を計算するようStringクラスを拡張してみた。
<strong>rpn.rb</strong>
<pre lang="ruby">
class String
  def rpn
    @expr = self.split(" ")
    stack = Array.new

    @expr.each {|i|
      if i == "+" || i == "-" || i == "*" || i == "/"
        stack = calc(i, stack)
      else
        stack < < i
      end
    }

    return stack[0]
  end

  private
  def calc(operator, stack)
    return Array(stack[1..-1].inject(stack[0].to_i){|result, i|
      reslut = result.__send__(operator, i.to_i)
    })
  end
end
</pre>
</pre><pre lang="ruby">
require 'rpn.rb'
"2 8 +".rpn #=> 10
"4 6 -".rpn #=> -2
"81 9 /".rpn #=> 9
"4 3 *".rpn => 12
"3 7 + 10 20 + 2 * 10 + 80 -".rpn
#=>10
</pre>
入力は文字列で返り値が数値なのが違和感あるかもしれないけど、String#hexもそんな感じだし別にいいかなと。

最初はモジュールにして、それをStringクラスにincludeしようとか思ってたんだけど、モジュールにするとselfで自身の文字列を取得する方法がわからなくて断念。モジュールのselfだとモジュール自身を指しちゃうんだよね。

あとはcalcメソッドの中がなんか汚いのも気になるなぁ。

全然関係ないけど、後置記法よりSchemeみたいな前置記法の方がわかりやすいと思った。
</article><hr /><article><h2><a href="/2007/11/27/ruby_euclid/">2007-11-27 ユークリッドの互除法をRubyで書いた</a></h2><pre lang="ruby">
def euclid(a, b)
  return nil if a < b
  return (a%b).zero? ? b : euclid(b, a%b)
end
</pre>

Rubyは三項演算子でもちゃんと値返すから3行目みたいな書き方が出来るからラクだ。</pre>
</article><hr /><article><h2><a href="/2007/11/24/the_little_schemer/">2007-11-24 The Little Schemer</a></h2><table class="g-tools_table"><tr><td colspan="2"><span class="g-tools_title"><a href="http://www.amazon.co.jp/gp/redirect.html%3FASIN=0262560992%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/0262560992%253FSubscriptionId=0G91FPYVW6ZGWBH4Y9G2" target="_top">The Little Schemer</a></span></td></tr><tr><td valign="top"><span class="g-tools_img"><a href="http://www.amazon.co.jp/gp/redirect.html%3FASIN=0262560992%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/0262560992%253FSubscriptionId=0G91FPYVW6ZGWBH4Y9G2" target="_top"><img src="http://ecx.images-amazon.com/images/I/115J0Y2ZQBL.jpg"  alt="The Little Schemer" /></a></span></td><td valign="top"><span class="g-tools_body">Daniel P. Friedman Matthias Felleisen Duane Bibby <br /><br /><strong>おすすめ平均</strong> <img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" /><br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="stars" />Schemeが好きになります<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="stars" />英語であるのが苦痛にならない楽しさ<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="stars" />面白いスタイル<br /><br /><a href="http://www.amazon.co.jp/gp/redirect.html%3FASIN=0262560992%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/0262560992%253FSubscriptionId=0G91FPYVW6ZGWBH4Y9G2" target="_top">Amazonで詳しく見る</a></span><span class="g-tools_by"> by <a href="http://www.goodpic.com/mt/aws/index.html" >G-Tools</a></span></td></tr></table>

Amazonさんから届いた。結構軽い本だから電車とかで読むのも悪くないかもしれない。洋書だけど、そんな難しい英語はなさそうだからそんなに苦労はなさそう。

The Five Rules
<dl>
<dt>The Law of Car</dt>
<dd>The primitive car is defined only for non-empty lists.</dd>
<dt>The Law of Cdr</dt>
<dd>The primitive cdr is defined only for non-empty lists. The cdr of any non-empty list is always another list.</dd>
<dt>The Law of Cons</dt>
<dd>The primitive cons takes two arguments. The second argument to cons must be a list. The result is a list.</dd>
<dt>The Law of Null?</dt>
<dd>The primitive null? is defined only for lists.</dd>
<dt>The Law of Eq?</dt>
<dd>The primitive eq? takes two arguments. Each must be a non-numeric atom.</dd>
</dl>
</article><hr /><article><h2><a href="/2007/11/24/ruby_brainfuck/">2007-11-24 RubyでBrainFuck処理系を書いてみた</a></h2><pre lang="ruby">
class BrainFuck
  def convert(code)
    @code = code
    @memory = Array.new
    @code_ptr = @mem_ptr = 0
    @output = ""

    while @code.size > @code_ptr
      @memory[@mem_ptr] ||= 0

      case @code[@code_ptr]
      when ?>
        @mem_ptr += 1
      when ?< raise ArgumentError if @mem_ptr.zero?
        @mem_ptr -= 1
      when ?+
        @memory[@mem_ptr] += 1
      when ?-
        @memory[@mem_ptr] -= 1
      when ?.
        @output += @memory[@mem_ptr].chr
      when ?,
        @memory[@mem_ptr] = $stdin.getc
      when ?[
        if @memory[@mem_ptr].zero?
          nest = 1
          until nest.zero?
            @code_ptr += 1
            case @code[@code_ptr]
            when ?[
              nest += 1
            when ?]
              nest -= 1
            end
          end
        end
      when ?]
        if @memory[@mem_ptr].nonzero?
          nest = 1
          until nest.zero?
            @code_ptr -= 1
            case @code[@code_ptr]
            when ?[
              nest -= 1
            when ?]
              nest += 1
            end
          end
        end
      end
      @code_ptr += 1
    end

    return @output
  end
end
</pre>
こんな感じで使う。
</pre><pre lang="ruby">
hello = "++++++++[>+++++++++< -]>." # H
hello += "< +++++[>++++++< -]>-."         # e
hello += "< ++[>+++< -]>+."                      # l
hello += "."                                                 # l
hello += "+++."                                          # o

bf = BrainFuck.new
p bf.convert(hello) #=> Hello
</pre>

[と]の処理内容が似てるのが気になる。似てるっていうかほとんど一緒なんだよね。なんかこううまく抽象化することはできないものか。あと無意味にインスタンス変数使い過ぎだな。
</article><hr /><article><h2><a href="/2007/11/22/re_startruby/">2007-11-22 Re: Try Ruby! 第1章</a></h2>msngさんがstartRubyというブログを始めたようです。せっかくなんで少しだけ補足しとこうかな。

<a href="http://startruby.com/20071122.html">Try Ruby! 第1章</a>

<h2>演算子(一部除く)は再定義可能なメソッド</h2>
Rubyの演算子は一部を除いて再定義可能なメソッド。例えば「+」演算子をメソッド呼び出しと同じ構文で書くことができる。
<pre lang="ruby">
1 + 1
#=> 2
1.+(1)
#=. 2
</pre>
メソッド呼び出しの構文
<blockquote>
オブジェクト.メソッド名(引数1, 引数2,  ....)
</blockquote>
ちなみにこの構文のオブジェクトのことをレシーバって言います。なぜかと言うと、メソッドを呼び出すことを「オブジェクトにメッセージを送る」と表現するので、オブジェクトはメッセージを受け取る(レシーブする)側なのでレシーバ。

ちなみに一部のメソッドは組込み演算子なので再定義することは不可能です。=とか!とか&&とかは無理。そこらへんはリファレンスを見るように。

<h2>mathオブジェクトとtextオブジェクト</h2>
これは多分、Numeric(数値)クラスとString(文字列)クラスのオブジェクトって意味だと思う。
<pre lang="ruby">
1.class
#=> Fixnum
"aaa".class
#=> String
</pre>
classメソッドはオブジェクトが何のクラスのオブジェクトなのかを調べるメソッド。つまり1はFixnumクラスのオブジェクト、文字列aaaはStringクラスのオブジェクトってこと。

なんで最初にNumericクラスって言ってるのに、1のクラスがFixnumクラスなのかと言うとFixnumクラスはNumericクラスのサブクラスだから。他にもFloatクラスとかある。
<img src="http://farm3.static.flickr.com/2257/2052393193_d80b5f873a.jpg?v=0"/>

<h2>msngさんがんばって!</h2>
そんなわけで適当に補足してみました。細かいところはリファレンスにも載ってるから一度見てみるといいと思う。最近503エラーがしょっちゅうでてるけどね・・・

<a href="http://www.ruby-lang.org/ja/man/">Rubyリファレンス</a>

UK STUDIOはstartRubyを応援しています。
</article><hr /><article><h2><a href="/2007/11/18/ruby_amazon/">2007-11-18 Ruby/Amazonライブラリ</a></h2>URL:<a href="http://www.caliban.org/ruby/ruby-amazon.shtml">http://www.caliban.org/ruby/ruby-amazon.shtml</a>

ちょっとAWSを使うプログラムを書こうと思ったので、準備としてRuby/Amazonライブラリを試してみた。
<h2>Ruby/Amazonのインストール</h2>
<ol>
<li>ライブラリのアーカイブを<a href="http://www.caliban.org/ruby/ruby-amazon.shtml#files">ダウンロード</a></li>
<li>アーカイブを解凍</li>
<li>解凍してできたディレクトリにsetup.rbがあるので、それを使用してインストール</li>
</ol>
<pre lang="bash">
% ruby setup.rb config
% ruby setup.rb setup
% ruby setup.rb install
</pre>
<h2>ISBN/ASINで検索</h2>
<h3>ソースコード</h3>
<pre lang="ruby">
#! ruby -Ku

require 'amazon/search'
include Amazon::Search

DEV_TOKEN = "****************"
ASSOCIATE_ID = "ukstudio0c-22"

request = Request.new(DEV_TOKEN, ASSOCIATE_ID, "jp")

# ASIN/ISBNで検索
res = request.asin_search("4274066428", LITE) # HEAVYを指定した場合、詳細な情報が得られる

# ヒット数
puts res.products.size #=> 1 ASINでの検索なので1件のみ該当

# ヒットした製品の情報
puts res.products[0]
</pre>
<h3>実行結果</h3>
<pre lang="bash">
asin             = "4274066428"
authors          = ["Dave Thomas", "Chad Fowler", "Andy Hunt", "田和 勝", "まつもと ゆきひろ"]
availability     = "通常24時間以内に発送"
catalog          = "Book"
image_url_large  = "http://ecx.images-amazon.com/images/I/4151YFZ27NL.jpg"
image_url_medium = "http://ecx.images-amazon.com/images/I/21QGW56WGCL.jpg"
image_url_small  = "http://ecx.images-amazon.com/images/I/11V7Q88BZ3L.jpg"
list_price       = "￥ 3,990"
manufacturer     = "オーム社"
our_price        = "￥ 3,990"
product_name     = "プログラミングRuby 第2版 言語編"
release_date     = "2006/08/26"
url              = "http://www.amazon.co.jp/gp/product/4274066428%3ftag=ukstudio0c-22%26link_code=xm2%26camp=2025%26dev-t=0GTT93KAWBX07WMKM002"
used_price       = "￥ 3,200"
</pre>
<h2>キーワード検索</h2>
<h3>ソースコード</h3>
Requestオブジェクトを作るところまでは同じなので省略。
<pre lang="ruby">
res = request.keyword_search("ruby", 'books', LITE) # booksはモードの指定。musicとか。

# ヒット数
puts res.products.size #=> 11/18日現在、10件ヒットした。なんか少ないな・・・

# ヒットした製品のタイトルを表示
res.products.each{|item|
  puts item.product_name
}
</pre>
<h3>実行結果</h3>
<pre lang="bash">
The Ruby (ザ・ルビー) 2007年 12月号 [雑誌]
Ruby on Rails入門―優しいRailsの育て方
たのしいRuby 第2版 Rubyではじめる気軽なプログラミング
プログラミングRuby 第2版 言語編
プログラミングRuby 第2版 ライブラリ編
Rubyではじめるゲームプログラミング―人気の国産言語で、誰でも簡単にゲームが作れる! (I/O BOOKS)
基礎Ruby on Rails (IMPRESS KISO SERIES)
Rubyレシピブック 第2版 268の技
はじめよう Ruby on Rails
WEB+DB PRESS Vol.38
</pre>
<h3>追記(07-11-19)</h3>
キーワード検索で10件しかヒットしなかったのはkeyword_searchメソッドにALL_PAGESオプションを指定してなかったためでした。
<h3>キーワードがヒットしなかった場合</h3>
検索したキーワードで何もヒットしなかった場合、例外が発生するみたいなので例外処理が必要。
<pre lang="bash">
/opt/local/lib/ruby/site_ruby/1.8/amazon/search.rb:1172:in `get_args': There are no exact matches for the search. (Amazon::Search::Request::SearchError)
</pre>
</article><hr /><article><h2><a href="/2007/11/16/coding_rule_ruby/">2007-11-16 個人用のコーディング規約を書き始めたんよ</a></h2><a href="/coding_rule/">CodingRule</a>

とりあえずはRubyから書き始めたんよ。思ったよりまとめるのが大変。

と言うより、普段何も考えてないのがわかる。暗黙的というか、その場のフィーリングで決めてるようで以前のRubyプログラムを見なおしてみると、スペースの取り方とかメソッド・クラス名が結構バラバラ。

以下の規約も参考にしつつ、少しずつまとめてみたいと思う。

<ul>
<li>前田さんの<a href="http://shugo.net/ruby-codeconv/codeconv.html">Rubyコーディング規約</a></li>
<li>青木さんの<a href="http://www.loveruby.net/w/RubyCodingStyle.html">RubyCodingStyle</a></li>
<li>id:cho45さんの<a href="http://lab.lowreal.net/trac/wiki/CodingRule/Ruby">Ruby Language Coding Rule</a></li>
</ul>

追記(07/11/18): CodingRuleページ内のリンクが間違ってたから修正した
</article><hr /><article><h2><a href="/2007/11/01/ruby_fizzbuzz_2/">2007-11-01 RubyでFizzBuzz #2</a></h2><a href="http://uk-studio.net/2007/10/28/ruby_fizzbuzz/">RubyでFizzBuzz</a>の第二弾。大分スッキリしたと思うんだけどどでしょ。
<pre lang="ruby">
fizzbuzz = (1..100).map{|i|
if i%5 == 0 && i%3 == 0 : "FizzBuzz"
elsif i%5 == 0 : "Buzz"
elsif i%3 == 0 : "Fizz"
else i end
}</pre>
</article><hr /><article><h2><a href="/2007/10/30/ruby_prime/">2007-10-30 Rubyで素数を求めるプログラムを書いた</a></h2>引数に入れた値までの素数を配列で返すRubyのクラスを書いてみた。アルゴリズムは<a href="http://ja.wikipedia.org/wiki/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9">エラトステネスの篩</a>を使用。
<strong>generate_prime.rb</strong>
<pre lang="ruby">
class GeneratePrime
  def generate_prime(max_num)
    if max_num < 2 then return nil
    elsif max_num == 2 then return 2 end

    search_list = (2..max_num).to_a # 探索リスト
    prime_list = Array.new          # 素数リスト

    # 素数の探索
    begin
      prime_list << search_list[0]
      search_list.each_index{|i|
        if search_list[i] % prime_list[-1] == 0 then
          search_list.delete_at(i)  # 素数リストに加えた数の全ての倍数を削除
        end
      }
    end while search_list[-1] > (prime_list[-1] * prime_list[-1])

    # 素数リスト及び、探索リストに最後まで残っていた数が素数
    return prime_list.concat(search_list)
  end
end</pre>
<strong>generate_prime_test.rb</strong>
<pre lang="ruby">
require 'test/unit'
require 'generate_prime'

class TestGeneratePrime < Test::Unit::TestCase
  def setup
    @prime = GeneratePrime.new
  end
  def test_generate_prime
    assert_equal(nil, @prime.generate_prime(1))
    assert_equal([2,3,5,7], @prime.generate_prime(10))
    assert_equal([2,3,5,7,11,13,17,19,23,29], @prime.generate_prime(30))
  end
end</pre>
<strong>テスト結果</strong>
</pre><pre>
% ruby generate_prime_test.rb
Loaded suite generate_prime_test
Started
.
Finished in 0.000454 seconds.

1 tests, 3 assertions, 0 failures, 0 errors</pre>
テストが不十分な気もするけど多分大丈夫なはず。・・・多分。
</article><hr /><article><h2><a href="/2007/10/28/activerecord/">2007-10-28 ActiveRecordを使ってみる</a></h2>ActiveRecordはRubyOnRailsのO/Rマッパーとして有名ですが、Railsに依存しているわけではなく単体で使えます。

<h2>DBを用意する</h2>
なにはともあれ、DBがないと始まらないので適当に用意します。

<pre lang="sql">create database ar;
 use ar;
 create table users (
   id int unsigned not null auto_increment,
   name varchar(50),
   age int,
   primary key (id)
 );
</pre>

ユーザ名と年齢を管理するテーブルってことで。

<h2>DBへの接続とマッピング</h2>

<pre lang="ruby">
require 'rubygems'
require_gem 'activerecord'

# ARで接続
ActiveRecord::Base.establish_connection(
  :adapter    =>      'mysql',
  :host       =>      'localhost',
  :username   =>      'ユーザ名',
  :password   =>      'パスワード',
  :database   =>      'ar',
  :socket     =>      '/tmp/mysql.sock'
)

# マッピングクラスを定義
class User < ActiveRecord::Base
end
</pre>

データベースへのコネクションはActiveRecord::Base.establish_connectionで作られます。特にむずかしいところはないですね。socketは必ず書く必要はないです。書かない場合は/tmp/mysql.sockを見にいくのかな。

ActiveRecord::Baseを継承することでマッピングクラスを定義することができます。クラス名がUserusersテーブルへのマッピングを定義していることになります。クラスを単数形、テーブル名を複数形にすることで自動的にマッピングされます。いわゆるCoC(Convention over Configuration)ってやつです。

<h2>データの保存</h2>
newメソッド、もしくはcreateメソッドを使用し、ARオブジェクトを作成することでDBにデータを保存(Insert)することができます。newとcreateの違いは、newは明示的にsaveメソッドを実行する必要があり、createは自動的にsaveメソッドも実行されます。

</pre><pre lang="ruby">
# ARオブジェクトを作成
user = User.new(:name => "UK", :age => 20)
user.save    # DBに格納
</pre>

<pre lang="ruby">
# ARオブジェクトを作成
user = User.create(:name => "UK", :age =>20) # この時点でDBに格納される
</pre>

<img src="http://farm3.static.flickr.com/2121/1590439456_c3203f167b.jpg?v=0" />

<h2>データの検索</h2>
<img src="http://farm3.static.flickr.com/2137/1786644895_9bfe2b148c.jpg?v=0" />
データが1件だけじゃ少ないので数件ほど追加しました。

データの検索(Select)にはfindメソッドを使用します。他にもfind_allとか、find_by_sqlとかあるけどとりあえずfindのみの説明で。ちなみにfind_allは非推奨的な雰囲気。find(:all)を使えってことですね。

<blockquote>
DEPRECATION WARNING: find_all is deprecated and will be removed from Rails 2.0 ( use find(:all, ...)) See http://www.rubyonrails.org/deprecation for details.
</blockquote>

<h3>findメソッド</h3>
findメソッドの引数にIDを指定することで、該当するデータのオブジェクトが得られます。IDは複数指定することが可能でその場合の戻り値は配列です。:allを指定すると、 全件分のオブジェクトが得られます。こちらの場合も配列です。:firstを指定すると、先頭のオブジェクトを得られます。

<pre lang="ruby">
p User.find(1) # ID = 1のオブジェクト
=> #<user :0x147fbe8 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>
p User.find(1,4) # ID =1, ID = 4 のオブジェクトを格納した配列
=> [#</user><user :0x1476ed0 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>,
 #</user><user :0x147709c @attributes={"name"=>"bar", "id"=>"4", "age"=>"38"}>]
p User.find([2]) # ID = 2のオブジェクトを格納した配列
=> [#</user><user :0x14711d8 @attributes={"name"=>"hoge", "id"=>"2", "age"=>"40"}>]
p User.find(:all) # 全件分のオブジェクトを格納した配列
=> [#</user><user :0x140fca8 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>, #</user><user :0x140fc94 @attributes={"name"=>"hoge", "id"=>"2", "age"=>"40"}>, #</user><user :0x140fc6c @attributes={"name"=>"foo", "id"=>"3", "age"=>"14"}>, #</user><user :0x140fc44 @attributes={"name"=>"bar", "id"=>"4", "age"=>"38"}>]
p User.find(:first) # 先頭のオブジェクト
=> #</user><user :0x140cd28 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>
</user></pre>

各カラムのデータにアクセスする場合は以下のようにします。

<pre lang="ruby">
p User.find(1).name # UK
p User.find(1,4)[1].age # 38
p User.find([2])[0].name # hoge
p User.find(:all)[3].name # bar
p User.find(:first).age # UK
</pre>

<h3>ActiveRecord::RecordNotFound</h3>
ちなみに存在しないID(この場合だと5とか)を指定すると例外(ActiveRecord::RecordNotFound)が発生するので注意して下さい。

<h3>条件文の指定</h3>
普通に考えて、データへのアクセスにIDの指定とか不便すぎますよね。次は引数に条件文を与えてみたいと思います。SQLで言う、where文に該当します。

<pre lang="ruby">
p User.find(:first, :conditions => {:name => "UK"})
=> #<user :0x107fa84 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>
p User.find(:first, :conditions => {:name =>"hoge", :age => 40})
=> #</user><user :0x29954ec @attributes={"name"=>"hoge", "id"=>"2", "age"=>"40"}>
p User.find(:first, :conditions => {:name => "aaa"})
=> nil
</user></pre>

条件文は:conditionsで指定します。1番目のfindはnameカラムのデータが"UK"に該当するものから先頭のオブジェクトを返します。ここで:firstの指定を:allに変更すると:conditionsに該当する全てのオブジェクトを配列で返します。

<pre lang="ruby">
User.crate(:name => "UK", :age => 20) # ID = 1と同じデータを保存
p User.find(:fist, :conditions => {:name => "UK"}
=> #<user :0x2980718 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>
p User.find(:all, :conditions => {:name => "UK"}
=> [#</user><user :0x297b45c @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>, #</user><user :0x297b614 @attributes={"name"=>"UK", "id"=>"5", "age"=>"20"}>]
</user></pre>

<h3>パラメータによるサニタイズ</h3>
上記のやり方だとパラメータを直接クエリに挿入します。いわゆるサニタイズと言ったものは行っていません。それだと流石にまずいと思うので以下のようにパラメータ使用します。

<pre lang="ruby">
p User.find(:all, :conditions => ["name = ? and age = ?", "UK", 20])
=> [#<user :0x296aa08 @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>, #</user><user :0x296abc0 @attributes={"name"=>"UK", "id"=>"5", "age"=>"20"}>]
</user></pre>

このようにしてパラメータを指定することで"UK"と20はサニタイズされます。

<h3>名前付きパラメータ</h3>
パラメータを使用している場合、クエスチョンマークが増えすぎるとわかりにくくなる時があります。その場合は名前つきパラメータを使用します。クエスチョンマークの代わりにシンボルを使用し、シンボルをキーにしたハッシュを渡します。

<pre lang="ruby">
User.find(:all, :conditions => ["name = :name and age = :age", {:name => "UK", :age => 20}])
=> [#<user :0x2962c7c @attributes={"name"=>"UK", "id"=>"1", "age"=>"20"}>, #</user><user :0x2962e34 @attributes={"name"=>"UK", "id"=>"5", "age"=>"20"}>]
</user></pre>

<h2>データの上書き保存</h2>
データの上書き保存(Update)するにはfindメソッドなどでARオブジェクトを作成、操作しsaveメソッドで行ないます。

<pre lang="ruby">
user = User.find(:first, :conditions => {:name => "hoge"})
p user.age # 40
user.age =69
user.save

User.find(:first, :conditions => {:name => "hoge"})
=> [#<user :0x292d694 @attributes={"name"=>"hoge", "id"=>"2", "age"=>"69"}>]
</user></pre>

<h2>データの削除</h2>
データの削除(Delete)はdeleteメソッドや、destroyメソッドを使用します。

<pre lang="ruby">
User.delete(1) # ID = 1を削除

user = User.find(:first, :conditions => {:name => "UK"})
user.destory # name が "UK"のデータを削除
</pre>

<h2>雑感</h2>
とりあえずざっとActiveRecordに触れてみましたが、DBをRubyのオブジェクトのように扱えるのは思いの外気持ちがいいですなー。ただ、プライマリーキー名が"id"固定なところやテーブル名を複数形云々のあたりが気になる人はいるのかなぁと。あと複合キーとかどうするんだーとか。そういうところを気にしないので済むのであれば、ActiveRecordはかなり良いと思います。

それにしてもコードがみづらいことこの上ないですね・・・そのうちなんとかしたいところです。

<a href="http://www.amazon.com/gp/redirect.html%3FASIN=1590598474%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/1590598474%253FSubscriptionId=1N9AHEAQ2F6SVD97BE02" title="Click and drag this image to the post editor"><img src="http://ecx.images-amazon.com/images/I/21rVApqb6cL.jpg" width="121" /></a>
</article><hr /><article><h2><a href="/2007/10/28/ruby_fizzbuzz/">2007-10-28 RubyでFizzBuzz</a></h2>今更ながらにFizzBuzz問題をRubyで問いてみる。前は確かPHPだけで問いて、Rubyで問いてなかったと思うから。

<strong>ループ内で出力</strong>
<pre lang="ruby">
100.times(){|i|
  i += 1
  if i%5 == 0 && i%3 == 0 then
    puts "FizzBuzz"
  elsif i%5 == 0
    puts "Buzz"
  elsif i%3 == 0
    puts "Fizz"
  else
    puts i
  end
}</pre>
<strong>配列を作ってそれを出力</strong>
<pre lang="ruby">
fizzbuzz = Array.new(100){|i|
  i += 1
  if i%5 == 0 && i%3 == 0 then
    "FizzBuzz"
  elsif i%5 == 0
    "Buzz"
  elsif i%3 == 0
    "Fizz"
  else
    i
  end
}
puts fizzbuzz</pre>
まぁ、普通ですな。後々データを再利用する可能性を考えると、ループ内で出力するより配列を作った方がいいかなとは思う。

if文のところはもうちょっとなんとかなる気もするけど、コードゴルフしてるわけでもないし、これでいいかな。再帰で書けって言われたら多分できないけど。

精進ですなー。
</article><hr /><article><h2><a href="/2007/10/26/programming_environment/">2007-10-26 Re:あなたの最も実力を発揮できる開発環境を教えてください</a></h2><a href="http://ujihisa.nowa.jp/entry/720100065b">rubyneko -
あなたの最も実力を発揮できる開発環境を教えてください</a>に反応してみる。
<h2>開発まっしーん</h2>
マシン: MacBook
OS     : Mac OS X
今年買ったMacBookの白が愛用機。サブディスプレイとかは無し。キーボードはJIS配列。ASCII配列にすればよかったと後悔している。日本語入力はAquaSKKを使用。
<h2>使用ソフト</h2>
<h3>Terminal.app</h3>
iTermは重いから標準のTerminalを使用。
<h3>vim</h3>
EmacsよりVi派です。あまり使いこなせてないけど。
<h3>zsh</h3>
MacBookを買った時に、zshを薦められて以来使用。こっちも使いこなせていない。キーバインドはviモードにしてる。
<h3>screen</h3>
キーバインドはデフォルトのまま。
<ul>
	<li>メインのソースコード編集</li>
	<li>テストコード編集 &amp; 実行</li>
	<li>メインのスクリプト実行</li>
	<li>ファイル操作</li>
</ul>
で、4画面ぐらいを使いわけ。最後のファイル操作は特に用意しないことも多い。
<h2>開発の流れ</h2>
作るものの規模にもよるけど、大体の構成を紙に書いて考えることが多い。Webアプリなら画面設計のラフとか、ちょっとしたクラス図とか。

コード書くときは基本的にTDDもどきな感じでテストコードを書くようにしてる。テストコードを書くようになったのはつい最近でまだまだ慣れてない感じ。テストコード書きながら設計の細かいところを考えていく。

あまり横断的に作業せず、機能を1つ1つ作りこんでいく感じ。そうしないと性格的に最後の方になって、各機能それぞれ80%ぐらい出来てるけど、100%のものは1つも無いってことになりがち。

コード管理はSVN。テストが通っていないものはCommitしない方針。
<h2>オマケ</h2>
作業につまると、意味もなくViで:wをしたり、シェルでlsやpwdをしがち。
</article><hr /><article><h2><a href="/2007/10/14/ipodtouch_hack_ruby/">2007-10-14 iPod touchでRubyを動かす</a></h2><strong style="color: #ff0000">以下の作業は自己責任でお願いいたします。</strong>
<h2>Installer.appをインストールする</h2>
まずはRubyを入れるためにInstaller.appをiPod touchをインストールします。
基本的に以下のリンク通りに作業すれば問題ないはずです。

<a href="http://hostname.jp/wk/index.php?iPod%20Touch%20jailbreak%20for%20Windows">iPod Touch jailbreak for Windows</a>
<a href="http://hostname.jp/wk/index.php?iPod%20Touch%20jailbreak%20for%20OSX">iPod Touch jailbreak for OSX </a>
<h2>必要なアプリのインストール</h2>
Installer.appから以下のアプリをインストールします。
<ul>
	<li>System &gt; BSD Subsystem</li>
	<li>System &gt; MobileTerminal</li>
	<li>Sources &gt; Community Sources</li>
</ul>
BSD Subsystemを入れることでBSD由来のコマンドが使えるようになります。今回に限らずtouchをいじくり倒すのに必須のアプリかと。MobileTerminalはその名の通りTerminalです。Community SourcesはInstaller.appからインストールできるアプリが増えます。Rubyもこのなかに含まれています。
<h2>Rubyのインストール</h2>
Community SourcesをインストールすることでInstaller.appのアプリ一覧にRubyが増えているはずなので、そこからRubyをインストールします。
<h2>Rubyにパスを通す</h2>
<strike>Rubyにパスを通すために.zshenvをSSH経由で作成します。</strike>
<pre lang="bash"><strike>
% ssh -l root iPodtouchのIPアドレス
root@IPアドレス password:パスワードを入力

# vi /Applications/.zshenv

1: export PATH=/opt/iphone/bin:$PATH</strike></pre>
<strike>次にiPod touchのMobileTerminalから今つくった.zshenvを適用させます。</strike>
<pre lang="bash"><strike>
# # source /Applications/.zshenv
# # ruby -v
ruby 1.8.6 (2007-03-13 patchlevel 0)
[arm-darwin]</strike></pre>
どうやら.zshenvだとMobileTerminalを閉じるたびに設定がリセットされる模様。毎回Terminalを起動させる度にsourceするのもアレなのでlnコマンドでシンボリックリンクを作ることで対応します。

シンボリックリンクはSSH経由でrootで作成します。
<pre lang="bash">
% ssh -l root iPodtouchのIPアドレス
root@IPアドレス password:パスワードを入力

# ln -s /opt/iphone/bin/ruby /bin/ruby</pre>
これでMobileTerminalを閉じたあとでもRubyへのパスが通っているはずです。ただこの方法だとPerlやPHP、Pythonをインストールしたときもシンボリックリンクを用意しなければいけないですし、irbのシンボリックリンクも用意する必要があります。(irbはなんかエラーでてつかえないけど)

<img src="http://farm3.static.flickr.com/2133/1568034636_00c9cd91c8.jpg?v=0" />

できれば、PATHの設定をしてやった方が色々手間がないはずなので、やり方わかる人いたら教えていただけるとありがたいです。
<h2>オマケ</h2>
せっかくSSHを使えるようにしてあるんだからsshsでマウントすると便利ですよ。

<img src="http://farm3.static.flickr.com/2130/1567200415_f186903c3b.jpg?v=0" />
<h2>追記:irbがなくてもボクたちにはeval.rbがあるじゃないか!</h2>
irbは動かないけど、eval.rbならもしかして・・・？

ってことで試してみましたよ。SSHでeval.rbをtouchに送って実行!

<img src="http://farm3.static.flickr.com/2355/1573467889_1f56f2e5ba.jpg?v=0" />

<strong>できた!!</strong>

eval.rbはサンプルとしてRubyにくっついてると思うから探せばあると思う。もしわからなければソースを<a href="http://www.ruby-lang.org/ja/downloads/">ダウンロード</a>して、解凍すると/sample/eval.rbがあるからそれを使えばいいと思います。
<h2>追記</h2>

<h2>追記 2007/10/26</h2>
<a href="http://d.hatena.ne.jp/faultier/20071025/1193293222">[iPod touch][プログラミング]iPod touchでRubyを使うのはちょっと厳しいかも</a>
irbが動かない件をfaultierさんが検証していた様です。irbだけじゃなくて標準ライブラリもダメだったのね・・・
</article><hr /><article><h2><a href="/2007/10/06/mac_loginshell_zsh/">2007-10-06 Macのログインシェルをzshに変更する</a></h2><a href="http://uk-studio.net/2007/07/08/start-macbook/">以前</a>に一度設定はしていたのですがちょっとおかしなところ(screenがうまく起動しない、日本語が入力できないとか)がいくつかあったので再設定しました。
<h2>zsh-develをMacPortsでインストールする</h2>
どうやら最初からインストールされているzshではバージョンの4.24のため日本語が入力できないみたいなのでMacPortsであらたに4.3以上のものをインストールしなおします。
<pre>
$sudu port install zsh-devel
Enter password:</pre>
インストールが終わると、/opt/local/binにzsh-4.3.4があるはずです。
<h2>ログインシェルの変更</h2>
ユーティリティのNetInfoマネージャもしくは、Terminalからchshを実行してログインシェルを変更します。今回はchshを使用して変更します。ちなみにTerminalの環境設定でシェルを指定している場合は「/usr/bin/loginを使ってデフォルトのログインシェルを実行する」に直しといて下さい。

追記:
MacPortsでインストールしたzshをそのまま登録しても不正なシェルだかなんだか言われてエラーがでるのでそれの対応も必要。/etc/shellsに今回使用するzshのパスを追記します。書くの忘れてたよ・・・

<pre>
$vi /etc/shells

<span style="color:#f00">/opt/local/bin/zsh-4.3.4</span>
</pre>

chshを実行すると編集画面にうつるので、Shellの項目に先程インストールしたzshのパスを指定します。
<pre>
$chsh

6: ##
7: Shell: <span style="color: #ff0000">/opt/local/bin/zsh-4.3.4</span>
8: Full Name: 名前</pre>
<h2>日本語設定</h2>
Terminal、zshの日本語設定を行います。
<h3>Terminalの日本語設定</h3>
<ol>
	<li>Cmd + i でターミナルインスペクタを開く</li>
	<li>エミュレーション-&gt;「非ASCII文字をエスケープする」のチェックをはずす</li>
	<li>ディスプレイ-&gt;日本語や中国語などにワイドグリフを使用する」と「ワイドグリフは2桁とカウントする」のチェックをオンにする</li>
	<li>文字 エンコーディングをUnicode(UTF-8)に変更する</li>
</ol>
<h3>zshの日本語設定</h3>
ホームディレクトリの.inputrcに以下の文を追記。ファイルが無い場合新規に作成する
<pre>
同じくホームディレクトリの.zshenvに以下の文を追記。lsで日本語をきちんと表示させるためにaliasで"ls -v"を指定しています。
<pre>
alias ls="ls -v"

export LANG=ja_JP.UTF-8</pre>
<h2>Terminalの再起動</h2>
設定を読みこむためにTerminalを一度再起動します。以下の点が確認できれば問題ないとおもいます。
<ol>
	<li>ログインシェルがzshになっている</li>
	<li>echo $SHELLで/opt/local/bin/zsh-4.3.4が出力される</li>
	<li>echo 日本語など日本語が入力でき、かつちゃんと出力される</li>
	<li>lsを発行したときに日本語のファイルやディレクトリが文字化けしていない</li>
</ol>
</article><hr /><article><h2><a href="/2007/09/28/rubyonrails_install_in_macbook/">2007-09-28 MacBookにRubyOnRailsをインストールする</a></h2>Railsを試すためにMacBookにRubyOnRailsをインストールしてみました。MacPortsは既にインストールされてるものとして話を進めるので、インストールしていない人はGoogleで調べるなりしてインストールしてくださいな。と言ってもRubyGemsのインストールでしか今回は使いませんけど。
<h2>まずはRubyGemsをインストール</h2>
MacPortsを利用してRubyGemsを入れます。rb-rubygemsという名前で登録されているはずです。
<pre>% sudo port install rb-rubygems</pre>
<a href="http://www.flickr.com/photo_zoom.gne?id=1447826801&amp;size=o"><img src="http://farm2.static.flickr.com/1008/1447826801_bf64321738.jpg?v=0" alt="install gem" /></a>
<h3>というかRubyGemsってなに?</h3>
いわゆるパッケージマネージャーってやつです。Perlで言うところのCPANみたいなものです。Rubyはまだ標準のパッケージマネージャーはありませんが、Railsがインストールできるということもあってか大抵はRubyGemsが使われるようです。
<ul>
	<li><a href="http://jp.rubyist.net/magazine/?0006-PackageManagement">Rubyist Magazine - シリーズ パッケージマネジメント 【第 1 回】 RubyGems (1)</a></li>
	<li><a href="http://d.hatena.ne.jp/secondlife/20061106/1162785661">川o・-・）＜2nd life - RubyGems パッケージの作り方 - rubyforge 登録まで</a></li>
	<li><a href="http://www.rubygems.org/">RubyGems Manuals</a></li>
</ul>
<h2>gemからRailsをインストール</h2>
<pre>% sudo gem install rails</pre>
<a href="http://www.flickr.com/photo_zoom.gne?id=1447826981&amp;size=o"><img src="http://farm2.static.flickr.com/1341/1447826981_c3eb32b601.jpg?v=0" alt="install rails" /></a>

gemをインストールしてしまえば、コマンド一発でRailsがインストール出来てしまいます。簡単ですね。
<h2>プロジェクトを作ってみる</h2>
<pre>% rails hello</pre>
<a href="http://www.flickr.com/photo_zoom.gne?id=1447827317&amp;size=o"><img src="http://farm2.static.flickr.com/1245/1447827317_f6bc5901ef.jpg?v=0" alt="create project" /></a>

gemでRailsをインストールしたら、プロジェクトを作ってみましょう。helloというディレクトリが出来て、その中にappディレクトリやRakefileとかが作られていれば問題ありません。ちなみにhelloというのはプロジェクト名です。
<h3>おまけ</h3>
キャプチャのMelchiorっていうのはエヴァネタです。マギシステムの。痛い子ですみません。
</article><hr /><article><h2><a href="/2007/09/27/ukstudio_server_down/">2007-09-27 UK STUDIOにアクセスできなかった件について</a></h2>サーバ料金の払い忘れで20日からサーバを停められてしまい、http://uk-studio.net/にアクセスできない状態でした。今日のお昼頃、振込みを終わらせ今はちゃんとアクセスできる状態です。

当サイトをご覧いただいてる方々にご心配とご迷惑をおかけしてしまったた事をお詫びいたします。
</article><hr /><article><h2><a href="/2007/09/07/ipod_touch/">2007-09-07 iPod touchを予約しました</a></h2><a href="http://www.amazon.co.jp/gp/redirect.html%3FASIN=B000IDHJ30%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/B000IDHJ30%253FSubscriptionId=1N9AHEAQ2F6SVD97BE02" title="Click and drag this image to the post editor"><img src="http://g-ec2.images-amazon.com/images/I/41eCukUobxL.jpg" width="500" /></a>

各所で話題のiPod touchですが、僕も16GBのやつをApple Storeから予約しました。Classicの160GBと迷ったんですが、無線LANやSafari、その他もろもろの機能の誘惑に負けました。出荷日まであと20日ぐらいあるのがなんともじれったい。

<a href="http://code.google.com/p/mobileterminal/">http://code.google.com/p/mobileterminal/</a>これ動くのかなぁ？
</article><hr /><article><h2><a href="/2007/09/05/codeblock/">2007-09-05 コードブロックとyield文</a></h2>メソッド内でyield文を使うことでメソッドからコードブロックを呼び出すことができます。yield文が呼び出されるたびに、ブロックに処理が移り、処理が終わるとyieldの直後の処理に移ります。
<pre lang="ruby">def exec_block
  yield
  puts "hoge"
end

exec_block{ puts "Hello,World"}

-----
Hello,Wold
hoge</pre>
ブロックで引数を使いたいときはこんな感じ。yield文に値を与えることでブロックからその値を変数として呼ぶことができます。
<pre lang="ruby">
def exec_block
  yield("foo", 3)
end

exec_block {|str,num| puts str * num}

-----
foofoofoo</pre>
ちなみに当たり前ですが、ブロックはブレース{}でなくても、do endでも問題ありません。１行のブロックの場合にはブレース、複数行の場合にdo endが一般的なようです。

コードブロックを使うとイテレータが実装できますけど、大抵は組み込みのもので事足りるのであまり自分でイテレータを作るっていうのは少ないのかもしれないですね。ま、Rubyの経験が少ないのでよくわかりませんが。
</article><hr /><article><h2><a href="/2007/08/22/job_change/">2007-08-22 職場を変えようと思います</a></h2>一部の人にはちらほら話してますけど、ちょっと職場を変えることを検討してます。できれば今年中には現在の職場に伝えて何らかの就職活動は行いたいところ。

職場を変えようと思った理由は、もっとコードを書きたい、刺激のある職場に行きたいってところですかね。今の職場はあまりプログラミングに専念できる職場じゃないですし、ついったーの人たちの様にWebが好き!プログラミングが好き!って人がいないんですよね。

今の環境が不満なら周りを変えるよう努力してみたら?っていう人もいるかもしれません。けれども僕はそこまでアクティブな人間ではない、むしろ周りに流されがちな人間なわけです。だったら、環境を変えるのも一つの手段なのではないかと思うのです。朱に交われば赤くなるとも言いますし。

じゃあこれからどうするの?と聞かれるとちょっと困ってしまう部分もあるんですよね。なんというか自分の｢売り｣がわからない。少なくとも雇う側としては、中途採用で雇うからには利益を出してもらいたい、つまり即戦力となる人材が欲しいはずなんです。その戦力となる部分が自分にあるのか正直わからない。チンケなプログラムは書けますが、周りを見てるとこれを｢売り｣にするのもおこがましいな、と。

まぁそんなこと言っても、結局は自分がどうしたいかってのが大事だと思うのでそれを踏まえつつ、もう一度自分を見つめ直そうかなと。なにができるんだろう、オレは。とりあえずWebとプログラミングは大好きです。少なくともこれだけはハッキリと言える。これも｢売り｣の一つに入るのかな。

ちなみに特に行きたい会社っていうのはないです。できればRubyを仕事にしてみたいなとは思いますけど。そんなわけでちょっと知り合いに貸してたピッケル本を今日返してもらいました。SICPと並行して読み進めていくつもりです。

実は就職活動とかせずに今の職場に就職したので(アルバイト-&gt;正社員)いまいち職場を変えるにあたってどうしたらいいのかとか、何に気をつけたらいいのかとかわかりません。知り合いの方にはいろいろ相談するかもしれませんが、よろしくお願いします。うちで雇ってもいいよ、っていう人がいらっしゃったら気軽にご連絡くださいw
</article><hr /><article><h2><a href="/2007/08/09/sicp_002/">2007-08-09 SICP第1章 手続きによる抽象の構築(1)</a></h2><h2>1.1 プログラムの要素</h2>
<dl> <dt>基本式</dt> <dd>言語が関わる最も単純なものを表す</dd> <dt>組合せ法</dt> <dd>より単純なものから合成物を作る</dd> <dt>抽象化法</dt> <dd>合成物に名をつけ、単一のものとして扱う</dd> </dl>
<h3>1.1.1式</h3>
schemeでは前置記法を採用している。慣れるまでが大変かも？
<pre lang="scheme">
(+ 137 349)
;;137 + 349

(+ 21 35 12 7)
;;21 + 35 + 12 + 7

(+ (* 3 5) (- 10 6))
;;(3 * 5) + (10 - 6)</pre>
<h3>1.1.2 組合せの評価</h3>
defineをつかって値と名前の対応付け。いわゆる変数の宣言。

当たり前だけど、値と名前の対応付けを解釈系は記憶している。その記憶のことを(大域)環境という。大域があるなら局所もあるのかな。
<h2>1.1.3 組合せの評価</h2>
<ol> 組合せの評価
	<li>組合せの部分式を評価する</li>
	<li>最左部分式の値である手続き(演算子)を、残りの部分式の値である引数(被演算子)に作用させる</li>
</ol>
<blockquote> すなわち評価の規則は、本質的に再帰的(recursive)である</blockquote>
一般的評価規則の例外を特殊形式(special forms)と言い、defineもそのうちの１つ。
<h3>1.1.4 合成手続き</h3>
合成手続きの作り方。例として二乗を返す合成手続きをサンプルにあげている。基本手続きが変数ならこっちは関数みたいなもの?
<pre lang="scheme">
(define (square x) (* x x))</pre>
<h3>1.1.5 手続き作用の置き換えモデル</h3>
作用的順序と正規順序の違いについて。

<dl> <dt>作用的順序</dt> <dd>引数を評価し、作用させる</dd> <dt>正規的順序</dt> <dd>完全に展開し、簡約する</dd> </dl>通常lispは作用的順序の評価を行うらしい。正規順序は必要になるまで評価を行わないってことだと思うけど、遅延評価って意味なのかな。遅延評価を知らないから何とも言えないけど。
<h3>1.1.6 条件式と述語</h3>
特殊形式「cond」と「if」について。condの方は条件(述語)を複数指定できるけど、ifは1つのみ。他の言語でいうelseifがcondにはあるけど、(schemeの)ifにはelseしかない感じ。

論理演算も使えて、andやor、notがある。andとorは特殊形式で、notは通常の手続き。手続きっていう言葉の意味が自分の中でちょっと曖昧かもしれない。
<h3>問題1.1</h3>
手計算でやって、実際に動かして答え合わせをした。
<h3>問題1.2
<pre lang="scheme">
(/ (+ 5 4) (- 2 (- 3 (+ 6 (/ 4 5)))))(* 3 (- 6 2) (- 2 7)))
;;-37/150</pre>
</h3>
<h3>問題1.3</h3>
<pre lang="scheme">
(define (square x) (* x x))
(define (square_add x y) (+ (square x) (square y)))

(define (ex1_3 x y z)
  (if (&lt; x y)
    (cond ((&lt; x z) (square_add y z))
              (else (square_add x y)))
    (cond ((&lt; y z) (square_add x z))
              (else (square_add x y)))
  )
)</pre>
結構時間かけちゃった。あらかじめsquareとsquare_addを定義してなるべく()を減らす作戦。書き終わった後に気づいたんだけど、最初の分岐はifなのにその次はcondなんだよね。両方ifでいいのにね。
<h3>問題1.4</h3>
問題の意味がうまく汲み取れないけど、多分「Schemeはこんなこともできるんだぜ!すげーだろ!」ってことを言ってるんだと思う。
<pre lang="scheme">
((if (&gt; b 0) + -) a b))
a = 3,b = -2
(- 3 -2) -&gt; 5
a = 3, b = 2
(+ 3 2) -&gt; 5</pre>
引数の値によって手続きも変えられるってことかな。
<h3>問題1.5</h3>
これも結構理解できるまで時間がかかった。

作用的順序の場合(test 0 (p))で先に(p)を評価する。けれど(p)の評価した時の結果が(p)だから無限ループになる。
<pre lang="scheme">
(test 0 (p))
(p)を先に評価
(test 0 (p))
以降繰り返し...</pre>
正規順序の場合は、(p)を評価するのは後回しにするから無限ループにはならないで済む
<pre lang="scheme">
(test 0 (p))
(if( (= 0 0)) 0 p))
(= 0 0)が#tだから0を返す</pre>
</article><hr /><article><h2><a href="/2007/08/03/sicp_001/">2007-08-03 いい加減SICPを読み始めることにした</a></h2><h2>宣言</h2>
いつ買ったのかわからないSICPをいい加減読むことにしました。どっかで宣言しないといつまでもやらなそうなので、エントリーで宣言して無理にでもやろうという魂胆。一応、成果はブログで書いていくつもりなので更新なかったら「さっさと読めよ、カス」って言ってやってください。

<h2>読もうとおもった理由</h2>
<ul>
	<li>個人的にすごいなって思う人は大抵SICPを読んでるっぽい</li>
	<li> 再帰とかクロージャとかよくわからない</li>
	<li>プログラミングの基礎がない</li>
	<li>schemeに興味がある</li>
	<li>若いうちに読んどくべきな気がする</li>
</ul>
まぁ、SICPを読み切ったら精神と時の部屋を出た後の悟空みたいに別人になれるんじゃねーかっていうそんな淡い期待を持ってるわけです。
<h2>ルール</h2>
<ul>
<li>1ページでも数行でもいいから毎日読む</li>
<li>わからなくても泣かない</li>
<li>練習問題はちゃんと解く</li>
<li>成果はブログでアウトプット</li>
</ul>
<h2>環境の用意</h2>
環境はMacBookなのでMacPortsでGaucheをインストールすることにしました。
<pre>
sudo port install gauche
</pre>
</article><hr /><article><h2><a href="/2007/07/16/070714_js/">2007-07-16 初心者向けJavaScript勉強会の資料公開と補足</a></h2>とある理由で僕主催の初心者向けのJavaScript勉強会 を14日行いました。とある理由はforestkさんのエントリーを参照ください(<a href="http://blog.livedoor.jp/forestk/archives/50357381.html">UK 主催の初心者向け Javascript 勉強会が生まれた経緯</a>)

会場は<a href="http://www.knocking.co.jp/">株式会社ノッキングオン</a>様にご提供いただきました。借りたい人ははてなキーワードの<a href="http://d.hatena.ne.jp/keyword/%A5%CE%A5%C3%A5%AD%A5%F3%A5%B0%A5%AA%A5%F3%A4%CE%B2%F1%B5%C4%BC%BC%BB%C8%A4%A4%A4%BF%A4%A4%21">ノッキングオンの会議室使いたい!</a>を利用するといいと思います。東麻布でプロジェクター &amp; ネット環境あり(優先ですがアクセスポイントを持参すれば無線も利用可能みたいです)の好環境ですのでかなりおすすめの物件となっております:-P

資料を公開しますので参考になれば幸いです。といっても、ほとんど入門書に書いてあるようなことですがwしかもif文とかの説明すげー適当だしね!

資料URL : <a href="http://www.slideshare.net/ukstudio/javascript/11">http://www.slideshare.net/ukstudio/javascript/11</a>

質問されたり、資料が半端な出来だったりしたのでちょっといくつか補足しておきます
<h2>補足1:連想配列とオブジェクト</h2>
連想配列とオブジェクトの違いはなにか?みたいな質問を受けたので簡単にお答えします。結論としてその２つに<strong>違いはない</strong>と僕は考えます。下のコードをみてください。
<pre lang="javascript">
var obj = {
  name : "UK",
  age : 20,
  birthday : "12月14日"
}

alert(obj.name);       //UK
alert(obj["name"]); //UK</pre>
1つ目のalertは資料でも説明したプロパティの呼び出しです。2つ目に注目してください。連想配列と同じ呼び出し方をしてますよね。今度は次のコードをみてください。
<pre lang="javascript">
var array = new Array();
array["name"] = "UK";
array["age"] = 20;
array["birthday"] = "12月14日";
alert(array["name"]);  //UK
alert(array.name);        //UK</pre>
上記のように連想配列でもドットシンタックス(.)を使って値を呼び出すことができます。これでなんとなくは連想配列とオブジェクトに違いはないと言った意味がわかってもらえたんじゃないでしょーか。

結局は連想配列もオブジェクトの一種(Arrayオブジェクト)なので元をたどっていけばもっとも基本的なオブジェクト(Objectオブジェクト)に行き着くってことです。これはArrayオブジェクトに限らず他のオブジェクト(DateオブジェクトとかFunctionオブジェクトとか)も最終的にはObjectオブジェクトに行き着きます。Objectオブジェクトがすべてのオブジェクトの出発点なのです。

ちょっとおまけですが、連想配列ではなく普通の配列を空のオブジェクトから作ってみます。
<pre lang="javascript">
var array = {
  0 : "インデックス0",
  1 : "インデックス1",
  2 : "インデックス2"
}

alert(array[0]);     //インデックス0
alert(array.0);           //エラー</pre>
とまぁ、こんな感じでプロパティのラベルに数値でつけてやれば配列のようなオブジェクトができます。あとはlengthプロパティだとかをつけてやればOKですね(どうやってプロパティの数を求めるんだとかは聞かないでね)

ただ、自分もちょっとよくわかってない点がarray.0でエラーがでるところですね。多分、0がプリミティブな数値リテラルとして扱われてるからかなとか思うんですがなんともかんとも。
<h2>補足2:数値オブジェクトと文字列オブジェクト</h2>
資料で数値も文字列もオブジェクトと書いてありますが厳密には違います。口頭で簡単に説明しましたがちゃんと文章で補足しておきます

文字列や数値にドットシンタックスをつけると一時的にプリミティブなリテラルからオブジェクトに変換されます。だからプロパティやメソッドを呼び出せるようになるわけです。あくまで<strong>変換</strong>なので厳密にはオブジェクトではない、ということです。
<h2>補足3:yoshioriさんのクイズ</h2>
<a href="http://yoshiori.org/blog/">yoshiori</a>さんのクイズで下のようなクイズがあったと思います。非プログラマな方にはいまいちわからない部分があったと思うので簡単に解説します。ちなみにswitch文とか他の問題は自分も理解があやふやなのでスルーです。
<pre lang="javascript">
alert(2 &amp; 3 == 1);    //0</pre>
まず各演算子には優先順位というものが存在します。(後で説明します)&amp;と==では==の方が優先順位が高いので3==1が先に評価され、falseが返されます。

falseというのは真偽値でいう偽の値でつまりは｢0｣です。そうすると2 &amp; 0のビット演算が行われ0が返されるという訳です。

とか言っても、ビット演算がわからないと思うのでそこを説明したいと思います。

ビット演算は2進数で計算されます。2進数っていうのは10進数が10で次の桁に繰り上がるように2で次の桁に繰り上がります。つまり0と1で表現します。

2を二進数で表すと0010になります。0は当然0000ですね。これを&amp;演算します。
<pre>
 0010
&amp;0000
------
 0000</pre>
&amp;演算というのは両方が1のときだけ1を返す演算です。今回は片方が0なので問答無用で全部0を返すということです。

ちなみにalert(7 &amp; 3)とかだったら3を返します。
<pre>
 0111
&amp;0011
---------
0011 = 3</pre>
ビット演算はあまり使う機会はないと思いますが、興味ある人は調べてみるといいと思います。
<h2>補足4:演算子の優先順位</h2>
上でちょろっと言いましたが、演算子には優先順位というものが存在します。簡単な例を出してみます。
<pre lang="javascript">
var a = 100 + 200 * 10;alert(a); // 2100</pre>
aの宣言のところで演算子は = , + , *の３つがあります。この３つでの優先順位は * &gt; + &gt; = のようになります。

* と + は数学と同じですからわかりやすいと思います。=が低いのは単純に計算が終わる前に値を代入しちゃうのはまずいよね?ってことです。

上の式を頭で計算するときもまずは200 * 10して2000を求めます。そしたら100  + 2000で2100が得られるので最後にa= 2100しますよね。それと同じことです。

他にも多種多様な演算子があってそれぞれ優先順位があります。さらに小難しい話をすると演算子の結合性といった話もでてきます。そこまで説明するのはちょっと骨が折れるので割愛しますが、なんとなくは演算子の優先順位といったものがわかっていただけると幸いです。
<h2>まとめ</h2>
かなり長いエントリーになってしまい申し訳ないです。本当はもうちょっとDOMまわりの補足もしたかったんですが、それはまた別の機会にお話するかエントリーをあげたいと思います。

今回の勉強会は参加する側ではなく主催するという僕にとっては初の試みでしたが、無事(?) になんとか終えることができました。様々な方にご協力いただき本当にありがとうございます。

第２回目希望の声もちらほらと聞こえており、うれしい限りです。もし次も発表する側であれば、ちゃんと準備して本番に望みたいと思います( 前日に資料作るとかあほだよねw)

追記

発表する側に立ってみて思ったことですが、あらためてアウトプットは大事だなと。本を読んだり、話を聞くよりも何倍も勉強になった気がします。デザイン勉強会の話もでてるみたいなので、もし発表するか迷ってる人はとりあえずやってみることをおすすめします。いろいろ不安もあると思いますが、みんないい人なのでなんとかなります、きっとw

あ、あと全体のまとめはちょっと書ききれなかったので<a href="http://www.hamashun.com/blog/2007/07/javascript.html">hamashun</a>さんのブログをみるよーに。
</article><hr /><article><h2><a href="/2007/07/08/start-macbook/">2007-07-08 MacBook始めました</a></h2>普段使っていたノートPC(Win) がどうやら逝ってしまったみたいなのでこの機会に念願のMacBookを手に入れました。
<table border="0" cellpadding="5">
<tr>
<td valign="top"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B000QUIURY/ukstudio0c-22/" target="_top"><img src="http://g-ec2.images-amazon.com/images/I/11Cbr66vqlL.jpg" alt="Apple MacBook White 2.16GHz Core 2 Duo/13.3/1G/120G/8x SuperDrive DL/Gigabit/BT/DVI MB062J/A" border="0" /></a></td>
<td valign="top"><font size="-1"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B000QUIURY/ukstudio0c-22/" target="_top">Apple MacBook White 2.16GHz Core 2 Duo/13.3/1G/120G/8x SuperDrive DL/Gigabit/BT/DVI MB062J/A</a></font><font size="-1">アップルコンピュータ  2007-05-16
売り上げランキング : 3083</font><font size="-1"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B000QUIURY/ukstudio0c-22/" target="_top">Amazonで詳しく見る</a></font><font size="-2"> by <a href="http://www.goodpic.com/mt/aws/index.html">G-Tools</a></font></td>
</tr>
</table>
MacBookを起動して行った設定のメモ
<h3>Vimの日本語対応</h3>
~/.vimrcを作り以下のように設定
<pre>
:set enc=utf-8

:set fenc=utf-8

:set fencs=iso-2022-jp,euc-jp,cp932</pre>
Terminalの設定変更。
<ol>
	<li>ファイル-&gt;情報をみる</li>
	<li>エミューレーション-&gt;非ascii文字をエスケープするのチェックをはずす</li>
</ol>
<h3>シェルをzshに変更</h3>
<ol>
	<li>ターミナル-&gt;環境設定</li>
	<li>｢このコマンドを実行する｣にチェック。パスに｢/bin/zsh」</li>
</ol>
これでターミナル起動時のシェルがzshになります。zshインストールしないといけないと思ってたらデフォルトでインストールされてた。

あとは、FirefoxとFirebugとGoogleBrowserSyncとかのAdd-onを少々。
</article><hr /><article><h2><a href="/2007/07/06/kanto_twitter/">2007-07-06 関東Twitter用Googleカレンダー</a></h2>Twitterがきっかけのイベントが多くて追いきれなくなってきたので専用のGoogleカレンダー作りました。全員に公開してるので気軽に登録してくださいな。

<a href="http://www.google.com/calendar/render?cid=dt9a336kkbl6jdm6pr2kooced0%40group.calendar.google.com" target="_blank"><img src="http://www.google.com/calendar/images/ext/gc_button1_ja.gif" border="0" /></a>

なにかのイベントの幹事とかで書き込み権限が欲しい人はyuki.0w0[at]gmail.com、もしくは<a href="http://twitter.com/ukstudio/">http://twitter.com/ukstudio/</a>まで連絡くださいな。
</article><hr /><article><h2><a href="/2007/06/24/twitter_meganeoff/">2007-06-24 Twitterメガネオフに参加してきました</a></h2>昨日(23日)、<a href="http://twitter.com/crema">crema</a>さん主催のTwitterメガネオフに参加してきました。cremaさんが<a href="http://twitter.com/crema/statuses/110880622">期間限定メガネ</a>発言をしたあと、メガネ好きがすかさず反応。じゃぁメガネオフしようという流れで開催されました。
<blockquote> woopsdez: <a href="http://twitter.com/woopsdez/statuses/110886312">@crema Twitter メガネオフ？？</a>

crema: <a href="http://twitter.com/crema/statuses/110890892">@woopsdez メガネオフ！いいかもですね（笑）</a>

ukstudio: <a href="http://twitter.com/ukstudio/statuses/110891732">   	 @crema @woopsdez メガネオフ参加したーいｗ *Tw*</a></blockquote>
当日の集合は渋谷のZOFF。せっかくなので何人かにメガネを選んでもらい、黒ぶちメガネを購入。結構好評みたいで選んでくれた人たちには感謝です!

さらに今回は<a href="http://twitter.com/hamashun">hamashun</a>さんから<strike>ライブドア</strike>Liveboor(誤字じゃないですｗ)公認のnowaTシャツいただきました!多分、今現在世界でたった一つなのではないかとｗ

一次会は<a href="http://r.gnavi.co.jp/b832600/">ベルギービール専門店ビアレストランBourgondische HEMEL</a>で行われました。ビールはビアレストランらしく、たくさん種類があってチンプンカンプンでしたが、頼んだビールはどれもおいしかったです。ビールは苦手だったけど、普通においしく飲めました。あの隠れ家的な雰囲気も個人的にGOOD!店員さんの愛想もよくオススメのお店かもしれません。

二次会は残った人たちで近くのダーツバーに行きました。ダーツ初心者の方が多かったみたいですが、いい具合に盛り上がってダーツの面白さもわかってもらえた様子。途中帰宅した数人を除いて始発までダーツしたり、食事しながらお話とかしました。

僕はデジカメももってなければ、携帯にカメラもついてないので写真をお見せすることができないのですが、他のカメラを持ってきた方がアップしてくれるはず・・・もし、アップしたり、レポを書いていただけた方はコメントもしくはトラックバックいただけるとうれしいです。

今回、オフが決まってから開催するまでの期間が短かったたりと、幹事のcremaさんは大変だったと思います。本当にお疲れ様でした。

というわけで第2回目も期待してます:-P

追記
prutoさんにnowaTシャツの画像をいただいたのでアップしますｗ

<img src="http://farm2.static.flickr.com/1329/608271981_b2e3bb6890.jpg?v=0" height="256" width="341" />

<img src="http://farm2.static.flickr.com/1202/608271973_2d941b3778.jpg?v=0" height="256" width="341" />
</article><hr /><article><h2><a href="/2007/06/23/domscripting/">2007-06-23 DOM Scripting 標準ガイドブックを買ってみた</a></h2><a href="http://www.amazon.co.jp/gp/redirect.html%3FASIN=4839922373%26tag=ukstudio0c-22%26lcode=xm2%26cID=2025%26ccmID=165953%26location=/o/ASIN/4839922373%253FSubscriptionId=1N9AHEAQ2F6SVD97BE02" title="Click and drag this image to the post editor"><img src="http://ec1.images-amazon.com/images/I/41ER9SJujTL.jpg" width="389" /></a>

ロクナナの中村享介さんが<strike>訳した</strike>監修した本です。こういう表紙は結構好きだなぁ。中は２色刷りで余白や行間がちょうど良く見やすい感じ。

デザイナーさんが、こういうJavaScriptやDOMの本からプログラミングに興味もってもらえるとうれしいなー。デザイナーもプログラマーももっとお互いのことを理解したほうがいいと思うんだよね。
</article><hr /><article><h2><a href="/2007/06/21/twitter_offline_party/">2007-06-21 twitterオフ会に参加してきました</a></h2>エントリー書くのおせぇよ!っていう突っ込みはスルーです。

6月の15日にamachang主催のtwitterオフ会があったので参加してきました。集合が18:30-19:00ってことで、明らかに職場の定時より早いので思わず有給とっちゃいました。

集合時間より結構早く行って青い看板？っていうか紙もってたらsunitiに写真とられて<a href="http://blog.grayash.com/archives/518">ブログにアップされた!</a>コレでオレも有名人だ!!

参加人数はなんと70人越え!!そんな大規模なオフなんて初めてでかなり緊張。誰が誰だかわからないかなぁとか思ってたけど、purprinさん作の名札のおかげでなんとかなった!ありがとう!

ほとんどの人がついったーでは話したことあるのに、実際に会うのは初めてとかでなんか不思議な感じ。はじめましてなのにはじめましてじゃない、みたいな。

ついったーのオフだからある程度Web業界の人が集まるのは予想してたんだけど、予想以上にギークな人があつまっててびっくりした。びびりなオレはあまり話しかけられませんでした。もったいない。

終わった後は、一部の人たちでカラオケに。カラオケたのしー。ほとんどの人は途中で帰ったりしたけど、俺入れて4人ぐらいは朝までいました。明日モバイル勉強会だというのにねーｗ

こっそりpurprinさんの寝顔をみちゃったのは内緒なんだぜ。

ついったー初めてそれなりに月日たったけど、本当にいろんな人との出会いがあったと思う。以前のオレからは考えられないぐらい。誰かがついったーで生活変わったって言ってたけど、大げさじゃなくて本当にそのとおりだと思う。

ありがとう、ついったー。
</article><hr /></div></body></html>