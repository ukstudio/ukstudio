<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><!--Use title if it's in the page YAML frontmatter--><title>特定のコミットが含まれるGitHub Pull Requestを開く</title><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css" /><link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/highlight.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all.js" type="text/javascript"></script><link href="/feed.xml" rel="alternate" title="atom" type="application/atom+xml" /><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12755601-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></head><body class="2015 2015_03 2015_03_26 2015_03_26_open_pull_request 2015_03_26_open_pull_request_index"><div class="header"><div class="header-navigation"><ul><li><i class="fa fa-twitter"></i><a href="http://twitter.com/ukstudio">Twitter</a></li><li><i class="fa fa-github-alt"></i><a href="http://github.com/ukstudio">GitHub</a></li></ul></div><div class="header-title"><a href="/">UKSTUDIO</a></div></div><div class="container"><article><h1>特定のコミットが含まれるGitHub Pull Requestを開く</h1><hr /><div class="article-body"><p>今日たまたまあるコミットが含まれているGitHubのPull Requestをサクッと探したい事案が発生した。というのも自分が以前書いたコードがどうしてこうなっているのかというのを知りたかったんだけど、commit messageだけじゃよくわからんかった(〜を実装したみたいなことを英語で書いてあっただけ)。</p>

<p>Pull Requestは割と丁寧に説明を書いているのできっとPull Requestのdescriptionを見ればわかりそうという感じはしたのだけれどパッとそれを開く手段がわからず、色々ググったりtwitterで教えてもらったりした結果下のようなfunctionをzshrcに書いた。</p>
<pre class="highlight shell"><span class="k">function </span>find-pr<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">parent</span><span class="o">=</span><span class="nv">$2</span><span class="o">||</span><span class="s1">&#39;master&#39;</span>
  git log <span class="nv">$1</span>..<span class="nv">$2</span> --merges --ancestry-path --reverse --oneline | head -n1
<span class="o">}</span>

<span class="k">function </span>find-pr-open<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">pr</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>find-pr <span class="nv">$1</span> <span class="nv">$2</span> | awk <span class="s1">&#39;{print substr($5, 2)}&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
  <span class="nb">local </span><span class="nv">repo</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>git config --get remote.origin.url | sed <span class="s1">&#39;s/git@github.com://&#39;</span> | sed <span class="s1">&#39;s/\.git$//&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
  open <span class="s2">&quot;https://github.com/</span><span class="k">${</span><span class="nv">repo</span><span class="k">}</span><span class="s2">/pull/</span><span class="k">${</span><span class="nv">pr</span><span class="k">}</span><span class="s2">&quot;</span>
<span class="o">}</span>
</pre><pre class="highlight text">find-pr-open REVISION
</pre>
<p>あまりシェルは得意ではないのでそこらへんは大目に見て欲しい。やってることはfind-prで該当のcommitが含まれているMerge commitを探してcommit messageからGitHub Pull Requestの番号を取り出している。リポジトリ名はgit configから取得して余計な文字はsedで削除。あとはURLを組み立ててブラウザで開くだけ。多分これでPull Requestを開けるはず。</p>

<p>なんにせよcommit messageはもうちょっと丁寧に書こうと思いました。</p>
</div></article></div></body></html>