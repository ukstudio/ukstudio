{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts//2007/11/18/ruby_amazon/","result":{"data":{"site":{"siteMetadata":{"title":"UKSTUDIO BLOG"}},"markdownRemark":{"id":"45d230d8-2c1a-50f9-8b2f-42bb1bda7550","excerpt":"URL:http://www.caliban.org/ruby/ruby-amazon.shtml ちょっとAWSを使うプログラムを書こうと思ったので、準備としてRuby/Amazonライブラリを試してみた。 require ‘amazon/search’\ninclude Amazon::Search DEVTOKEN…","html":"<p>URL:<a href=\"http://www.caliban.org/ruby/ruby-amazon.shtml\">http://www.caliban.org/ruby/ruby-amazon.shtml</a></p>\n<p>ちょっとAWSを使うプログラムを書こうと思ったので、準備としてRuby/Amazonライブラリを試してみた。</p>\n<h2>Ruby/Amazonのインストール</h2>\n<ol>\n<li>ライブラリのアーカイブを<a href=\"http://www.caliban.org/ruby/ruby-amazon.shtml#files\">ダウンロード</a></li>\n<li>アーカイブを解凍</li>\n<li>解凍してできたディレクトリにsetup.rbがあるので、それを使用してインストール</li>\n</ol>\n<pre lang=\"bash\">\n% ruby setup.rb config\n% ruby setup.rb setup\n% ruby setup.rb install\n</pre>\n<h2>ISBN/ASINで検索</h2>\n<h3>ソースコード</h3>\n<pre lang=\"ruby\">\n#! ruby -Ku\n<p>require ‘amazon/search’\ninclude Amazon::Search</p>\n<p>DEV<em>TOKEN = ”<strong><strong><strong>****</strong></strong></strong>”\nASSOCIATE</em>ID = “ukstudio0c-22”</p>\n<p>request = Request.new(DEV<em>TOKEN, ASSOCIATE</em>ID, “jp”)</p>\n<h1>ASIN/ISBNで検索</h1>\n<p>res = request.asin_search(“4274066428”, LITE) # HEAVYを指定した場合、詳細な情報が得られる</p>\n<h1>ヒット数</h1>\n<p>puts res.products.size #=> 1 ASINでの検索なので1件のみ該当</p>\n<h1>ヒットした製品の情報</h1>\n<p>puts res.products[0]</p>\n</pre>\n<h3>実行結果</h3>\n<pre lang=\"bash\">\nasin             = \"4274066428\"\nauthors          = [\"Dave Thomas\", \"Chad Fowler\", \"Andy Hunt\", \"田和 勝\", \"まつもと ゆきひろ\"]\navailability     = \"通常24時間以内に発送\"\ncatalog          = \"Book\"\nimage_url_large  = \"http://ecx.images-amazon.com/images/I/4151YFZ27NL.jpg\"\nimage_url_medium = \"http://ecx.images-amazon.com/images/I/21QGW56WGCL.jpg\"\nimage_url_small  = \"http://ecx.images-amazon.com/images/I/11V7Q88BZ3L.jpg\"\nlist_price       = \"￥ 3,990\"\nmanufacturer     = \"オーム社\"\nour_price        = \"￥ 3,990\"\nproduct_name     = \"プログラミングRuby 第2版 言語編\"\nrelease_date     = \"2006/08/26\"\nurl              = \"http://www.amazon.co.jp/gp/product/4274066428%3ftag=ukstudio0c-22%26link_code=xm2%26camp=2025%26dev-t=0GTT93KAWBX07WMKM002\"\nused_price       = \"￥ 3,200\"\n</pre>\n<h2>キーワード検索</h2>\n<h3>ソースコード</h3>\nRequestオブジェクトを作るところまでは同じなので省略。\n<pre lang=\"ruby\">\nres = request.keyword_search(\"ruby\", 'books', LITE) # booksはモードの指定。musicとか。\n<h1>ヒット数</h1>\n<p>puts res.products.size #=> 11/18日現在、10件ヒットした。なんか少ないな・・・</p>\n<h1>ヒットした製品のタイトルを表示</h1>\n<p>res.products.each{|item|\nputs item.product_name\n}</p>\n</pre>\n<h3>実行結果</h3>\n<pre lang=\"bash\">\nThe Ruby (ザ・ルビー) 2007年 12月号 [雑誌]\nRuby on Rails入門―優しいRailsの育て方\nたのしいRuby 第2版 Rubyではじめる気軽なプログラミング\nプログラミングRuby 第2版 言語編\nプログラミングRuby 第2版 ライブラリ編\nRubyではじめるゲームプログラミング―人気の国産言語で、誰でも簡単にゲームが作れる! (I/O BOOKS)\n基礎Ruby on Rails (IMPRESS KISO SERIES)\nRubyレシピブック 第2版 268の技\nはじめよう Ruby on Rails\nWEB+DB PRESS Vol.38\n</pre>\n<h3>追記(07-11-19)</h3>\nキーワード検索で10件しかヒットしなかったのはkeyword_searchメソッドにALL_PAGESオプションを指定してなかったためでした。\n<h3>キーワードがヒットしなかった場合</h3>\n検索したキーワードで何もヒットしなかった場合、例外が発生するみたいなので例外処理が必要。\n<pre lang=\"bash\">\n/opt/local/lib/ruby/site_ruby/1.8/amazon/search.rb:1172:in `get_args': There are no exact matches for the search. (Amazon::Search::Request::SearchError)\n</pre>","frontmatter":{"title":"Ruby/Amazonライブラリ","date":"November 18, 2007","description":null}},"previous":{"fields":{"slug":"posts//2007/11/16/coding_rule_ruby/"},"frontmatter":{"title":"個人用のコーディング規約を書き始めたんよ"}},"next":{"fields":{"slug":"posts//2007/11/22/re_startruby/"},"frontmatter":{"title":"Re: Try Ruby! 第1章"}}},"pageContext":{"id":"45d230d8-2c1a-50f9-8b2f-42bb1bda7550","previousPostId":"f6a195a1-9d65-5cce-9163-ea7233c12d90","nextPostId":"96bda395-aef9-55e9-8443-b377b2acb601"}},"staticQueryHashes":["2841359383"]}